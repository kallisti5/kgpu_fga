<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>KGPU: services/gaes/ecryptfs/crypto.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">KGPU
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('crypto_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">crypto.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/fs.h&gt;</code><br/>
<code>#include &lt;linux/mount.h&gt;</code><br/>
<code>#include &lt;linux/pagemap.h&gt;</code><br/>
<code>#include &lt;linux/random.h&gt;</code><br/>
<code>#include &lt;linux/compiler.h&gt;</code><br/>
<code>#include &lt;linux/key.h&gt;</code><br/>
<code>#include &lt;linux/namei.h&gt;</code><br/>
<code>#include &lt;linux/crypto.h&gt;</code><br/>
<code>#include &lt;linux/file.h&gt;</code><br/>
<code>#include &lt;linux/log2.h&gt;</code><br/>
<code>#include &lt;linux/scatterlist.h&gt;</code><br/>
<code>#include &lt;linux/slab.h&gt;</code><br/>
<code>#include &lt;asm/unaligned.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="ecryptfs__kernel_8h_source.html">ecryptfs_kernel.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for crypto.c:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c__incl.png" border="0" usemap="#services_2gaes_2ecryptfs_2crypto_8c" alt=""/></div>
<map name="services_2gaes_2ecryptfs_2crypto_8c" id="services_2gaes_2ecryptfs_2crypto_8c">
<area shape="rect" id="node15" href="ecryptfs__kernel_8h.html" title="ecryptfs_kernel.h" alt="" coords="325,96,448,123"/></map>
</div>
</div>
<p><a href="crypto_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structecryptfs__flag__map__elem.html">ecryptfs_flag_map_elem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structecryptfs__cipher__code__str__map__elem.html">ecryptfs_cipher_code_str_map_elem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a628468ef410c8d30feba27b5c6d9e77a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a628468ef410c8d30feba27b5c6d9e77a">ECRYPTFS_MAX_SCATTERLIST_LEN</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a628468ef410c8d30feba27b5c6d9e77a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a509e857b6cc1ef99c6b7cff012b4b5b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a509e857b6cc1ef99c6b7cff012b4b5b7">ECRYPTFS_DONT_VALIDATE_HEADER_SIZE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a509e857b6cc1ef99c6b7cff012b4b5b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a682465bf299e220de23b73a3f8e673e9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a682465bf299e220de23b73a3f8e673e9">ECRYPTFS_VALIDATE_HEADER_SIZE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a682465bf299e220de23b73a3f8e673e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a78a26bcd3062c8d4780d955d563b4f69"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a78a26bcd3062c8d4780d955d563b4f69">ecryptfs_decrypt_page_offset</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct page *dst_page, int dst_offset, struct page *src_page, int src_offset, int size, unsigned char *iv)</td></tr>
<tr class="separator:a78a26bcd3062c8d4780d955d563b4f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4edeaa3bc6ab6aaf996f7a8c002c74a1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a4edeaa3bc6ab6aaf996f7a8c002c74a1">ecryptfs_encrypt_page_offset</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct page *dst_page, int dst_offset, struct page *src_page, int src_offset, int size, unsigned char *iv)</td></tr>
<tr class="separator:a4edeaa3bc6ab6aaf996f7a8c002c74a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a600a433968f0fca6c59d0503e4a13adc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a600a433968f0fca6c59d0503e4a13adc">ecryptfs_to_hex</a> (char *dst, char *src, size_t src_size)</td></tr>
<tr class="separator:a600a433968f0fca6c59d0503e4a13adc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b9fe052c3394cc747e08e884df0926"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a53b9fe052c3394cc747e08e884df0926">ecryptfs_from_hex</a> (char *dst, char *src, int dst_size)</td></tr>
<tr class="separator:a53b9fe052c3394cc747e08e884df0926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9ebb3f8af0e14969d856f179bccc8d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#afe9ebb3f8af0e14969d856f179bccc8d">ecryptfs_calculate_md5</a> (char *dst, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, char *src, int len)</td></tr>
<tr class="separator:afe9ebb3f8af0e14969d856f179bccc8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5901e51bc8f4d9b71eb0c0692e483b6f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f">ecryptfs_crypto_api_algify_cipher_name</a> (char **algified_name, char *cipher_name, char *chaining_modifier)</td></tr>
<tr class="separator:a5901e51bc8f4d9b71eb0c0692e483b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4738f6aeb7582859b83cdbc08285349"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa4738f6aeb7582859b83cdbc08285349">ecryptfs_derive_iv</a> (char *iv, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, loff_t offset)</td></tr>
<tr class="separator:aa4738f6aeb7582859b83cdbc08285349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6d11d966fbe85483b98bf5cb2fec6a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab6d11d966fbe85483b98bf5cb2fec6a6">ecryptfs_init_crypt_stat</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:ab6d11d966fbe85483b98bf5cb2fec6a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83389a63b87e4af4d99cd464dae97beb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a83389a63b87e4af4d99cd464dae97beb">ecryptfs_destroy_crypt_stat</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:a83389a63b87e4af4d99cd464dae97beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51353a78eb90d12fba6d671d2e76896c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a51353a78eb90d12fba6d671d2e76896c">ecryptfs_destroy_mount_crypt_stat</a> (struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat)</td></tr>
<tr class="separator:a51353a78eb90d12fba6d671d2e76896c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a192ec172108f38b6c893f631d0ed6cc4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4">virt_to_scatterlist</a> (const void *addr, int size, struct scatterlist *sg, int sg_size)</td></tr>
<tr class="separator:a192ec172108f38b6c893f631d0ed6cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2557a0d17ec106c3b524579a1a68c17b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2557a0d17ec106c3b524579a1a68c17b">encrypt_scatterlist</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct scatterlist *dest_sg, struct scatterlist *src_sg, int size, unsigned char *iv)</td></tr>
<tr class="separator:a2557a0d17ec106c3b524579a1a68c17b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a740d9efeadec638412712e946d489058"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a740d9efeadec638412712e946d489058">ecryptfs_lower_offset_for_extent</a> (loff_t *offset, loff_t extent_num, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:a740d9efeadec638412712e946d489058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a667352484e3769a93d4d6756207a6294"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a667352484e3769a93d4d6756207a6294">ecryptfs_encrypt_extent</a> (struct page *enc_extent_page, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct page *page, unsigned long extent_offset)</td></tr>
<tr class="separator:a667352484e3769a93d4d6756207a6294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83ba6402513da64241081017b40210f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a83ba6402513da64241081017b40210f9">ecryptfs_encrypt_pages</a> (struct page **pgs, unsigned int nr_pages)</td></tr>
<tr class="separator:a83ba6402513da64241081017b40210f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ea5ca17a37e818f2bb40976b23adb9c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9ea5ca17a37e818f2bb40976b23adb9c">ecryptfs_encrypt_pages2</a> (struct page **pgs, unsigned int nr_pages)</td></tr>
<tr class="separator:a9ea5ca17a37e818f2bb40976b23adb9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26de129ca477fc9762d6750b5020914f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a26de129ca477fc9762d6750b5020914f">ecryptfs_encrypt_page</a> (struct page *page)</td></tr>
<tr class="separator:a26de129ca477fc9762d6750b5020914f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6d633b806e115227b076c421479e4ca"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af6d633b806e115227b076c421479e4ca">ecryptfs_decrypt_extent</a> (struct page *page, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct page *enc_extent_page, unsigned long extent_offset)</td></tr>
<tr class="separator:af6d633b806e115227b076c421479e4ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f0e0486293ab97cca8219ee1fee7f4b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a8f0e0486293ab97cca8219ee1fee7f4b">ecryptfs_decrypt_page</a> (struct page *page)</td></tr>
<tr class="separator:a8f0e0486293ab97cca8219ee1fee7f4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70334db0e206d80e643be63f141a4ab9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a70334db0e206d80e643be63f141a4ab9">decrypt_scatterlist</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct scatterlist *dest_sg, struct scatterlist *src_sg, int size, unsigned char *iv)</td></tr>
<tr class="separator:a70334db0e206d80e643be63f141a4ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ebf9f9d953fc4f0f1e464ab16e9773d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a8ebf9f9d953fc4f0f1e464ab16e9773d">ecryptfs_decrypt_pages</a> (struct page **pgs, unsigned int nr_pages)</td></tr>
<tr class="separator:a8ebf9f9d953fc4f0f1e464ab16e9773d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6806b87a57ada237cc52b391b0b70dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa6806b87a57ada237cc52b391b0b70dc">ecryptfs_init_crypt_ctx</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:aa6806b87a57ada237cc52b391b0b70dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a021875e559b602a9bd59ef32416337dc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a021875e559b602a9bd59ef32416337dc">set_extent_mask_and_shift</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:a021875e559b602a9bd59ef32416337dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0c1e94df9a9186bb509360c1476c353"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae0c1e94df9a9186bb509360c1476c353">ecryptfs_set_default_sizes</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:ae0c1e94df9a9186bb509360c1476c353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a010c33619300979023e302badcdbd3b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a010c33619300979023e302badcdbd3b5">ecryptfs_compute_root_iv</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:a010c33619300979023e302badcdbd3b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bad7026cdc7157c2d78fda1c58b5789"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0bad7026cdc7157c2d78fda1c58b5789">ecryptfs_generate_new_key</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:a0bad7026cdc7157c2d78fda1c58b5789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1f20c33cc83c9fae00176557a101d2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a4c1f20c33cc83c9fae00176557a101d2">ecryptfs_copy_mount_wide_flags_to_inode_flags</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat)</td></tr>
<tr class="separator:a4c1f20c33cc83c9fae00176557a101d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81000f6bbd25c79214005d46daa3d6ca"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a81000f6bbd25c79214005d46daa3d6ca">ecryptfs_copy_mount_wide_sigs_to_inode_sigs</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat)</td></tr>
<tr class="separator:a81000f6bbd25c79214005d46daa3d6ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a35c67336e7e2dc9545638ffedda7e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a43a35c67336e7e2dc9545638ffedda7e">ecryptfs_set_default_crypt_stat_vals</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat)</td></tr>
<tr class="separator:a43a35c67336e7e2dc9545638ffedda7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a076756b4a12fe2b1913c58313bed8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9a076756b4a12fe2b1913c58313bed8f">ecryptfs_new_file_context</a> (struct dentry *ecryptfs_dentry)</td></tr>
<tr class="separator:a9a076756b4a12fe2b1913c58313bed8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6351e3152155696288917740cc9c849d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6351e3152155696288917740cc9c849d">contains_ecryptfs_marker</a> (char *<a class="el" href="raid6test_8c.html#aa15520322cfd6ae88e1036d4706d4de3">data</a>)</td></tr>
<tr class="separator:a6351e3152155696288917740cc9c849d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70ef2b489032eed23b63b36ef67b99fc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a70ef2b489032eed23b63b36ef67b99fc">ecryptfs_process_flags</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, char *page_virt, int *bytes_read)</td></tr>
<tr class="separator:a70ef2b489032eed23b63b36ef67b99fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896178cbcc9f09e6954fc88c6652a8b8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a896178cbcc9f09e6954fc88c6652a8b8">write_ecryptfs_marker</a> (char *page_virt, size_t *written)</td></tr>
<tr class="separator:a896178cbcc9f09e6954fc88c6652a8b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50ad608c942c06e27fb6759d031cb1bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a50ad608c942c06e27fb6759d031cb1bc">ecryptfs_write_crypt_stat_flags</a> (char *page_virt, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, size_t *written)</td></tr>
<tr class="separator:a50ad608c942c06e27fb6759d031cb1bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac276c0609493e5a5bf8c1c78223877"><td class="memItemLeft" align="right" valign="top"><a class="el" href="helper_8c.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abac276c0609493e5a5bf8c1c78223877">ecryptfs_code_for_cipher_string</a> (char *cipher_name, size_t key_bytes)</td></tr>
<tr class="separator:abac276c0609493e5a5bf8c1c78223877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec4f1a07858b147d07a4691fccc9741"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9ec4f1a07858b147d07a4691fccc9741">ecryptfs_cipher_code_to_string</a> (char *str, <a class="el" href="helper_8c.html#aed742c436da53c1080638ce6ef7d13de">u8</a> cipher_code)</td></tr>
<tr class="separator:a9ec4f1a07858b147d07a4691fccc9741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fe598009db325ac45c099f00a506eaf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1fe598009db325ac45c099f00a506eaf">ecryptfs_read_and_validate_header_region</a> (char *<a class="el" href="raid6test_8c.html#aa15520322cfd6ae88e1036d4706d4de3">data</a>, struct inode *ecryptfs_inode)</td></tr>
<tr class="separator:a1fe598009db325ac45c099f00a506eaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a897cc3b03edffb1e113ad7aa251cd365"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a897cc3b03edffb1e113ad7aa251cd365">ecryptfs_write_header_metadata</a> (char *virt, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, size_t *written)</td></tr>
<tr class="separator:a897cc3b03edffb1e113ad7aa251cd365"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a726219be3d26c0f5d0cd3764aaf1dc10"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10">ecryptfs_write_headers_virt</a> (char *page_virt, size_t max, size_t *size, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct dentry *ecryptfs_dentry)</td></tr>
<tr class="separator:a726219be3d26c0f5d0cd3764aaf1dc10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3f04fde63f77ad0f5161ccdf102f8b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ace3f04fde63f77ad0f5161ccdf102f8b">ecryptfs_write_metadata_to_contents</a> (struct dentry *ecryptfs_dentry, char *virt, size_t virt_len)</td></tr>
<tr class="separator:ace3f04fde63f77ad0f5161ccdf102f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af3e655459e9f1bc093c1bcaab4cb26"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5af3e655459e9f1bc093c1bcaab4cb26">ecryptfs_write_metadata_to_xattr</a> (struct dentry *ecryptfs_dentry, char *page_virt, size_t size)</td></tr>
<tr class="separator:a5af3e655459e9f1bc093c1bcaab4cb26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f2f172cce958308b370bfd82334710"><td class="memItemLeft" align="right" valign="top">static unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac0f2f172cce958308b370bfd82334710">ecryptfs_get_zeroed_pages</a> (gfp_t gfp_mask, unsigned int order)</td></tr>
<tr class="separator:ac0f2f172cce958308b370bfd82334710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebe428f37c6e93d1e18cdc4a7b40e1f6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aebe428f37c6e93d1e18cdc4a7b40e1f6">ecryptfs_write_metadata</a> (struct dentry *ecryptfs_dentry)</td></tr>
<tr class="separator:aebe428f37c6e93d1e18cdc4a7b40e1f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc63e296860a38dd41bb90bd8bbcde51"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abc63e296860a38dd41bb90bd8bbcde51">parse_header_metadata</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, char *virt, int *bytes_read, int validate_header_size)</td></tr>
<tr class="separator:abc63e296860a38dd41bb90bd8bbcde51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7547fa51803046747c7184904e499062"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a7547fa51803046747c7184904e499062">set_default_header_data</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:a7547fa51803046747c7184904e499062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1971b0423a0e1cbe741f78712d319b20"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20">ecryptfs_read_headers_virt</a> (char *page_virt, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct dentry *ecryptfs_dentry, int validate_header_size)</td></tr>
<tr class="separator:a1971b0423a0e1cbe741f78712d319b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0328356e623d00183afc5c85cc63e932"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0328356e623d00183afc5c85cc63e932">ecryptfs_read_xattr_region</a> (char *page_virt, struct inode *ecryptfs_inode)</td></tr>
<tr class="separator:a0328356e623d00183afc5c85cc63e932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade462ad60d1c69a5246f7623f09374a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ade462ad60d1c69a5246f7623f09374a1">ecryptfs_read_and_validate_xattr_region</a> (char *page_virt, struct dentry *ecryptfs_dentry)</td></tr>
<tr class="separator:ade462ad60d1c69a5246f7623f09374a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f476d4db45796bb804042157fbd93fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0f476d4db45796bb804042157fbd93fa">ecryptfs_read_metadata</a> (struct dentry *ecryptfs_dentry)</td></tr>
<tr class="separator:a0f476d4db45796bb804042157fbd93fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac05661b742322849b06256613c2ee205"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac05661b742322849b06256613c2ee205">ecryptfs_encrypt_filename</a> (struct <a class="el" href="structecryptfs__filename.html">ecryptfs_filename</a> *filename, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat)</td></tr>
<tr class="separator:ac05661b742322849b06256613c2ee205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ab2be85b67e070ec5d18d375068a9af"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a3ab2be85b67e070ec5d18d375068a9af">ecryptfs_copy_filename</a> (char **copied_name, size_t *copied_name_size, const char *name, size_t name_size)</td></tr>
<tr class="separator:a3ab2be85b67e070ec5d18d375068a9af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89e7a8582efdfa475ae354125c5abb25"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25">ecryptfs_process_key_cipher</a> (struct crypto_blkcipher **key_tfm, char *cipher_name, size_t *key_size)</td></tr>
<tr class="separator:a89e7a8582efdfa475ae354125c5abb25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d0a5dfb857ae4cb4873001e6393d79"><td class="memItemLeft" align="right" valign="top">int __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a00d0a5dfb857ae4cb4873001e6393d79">ecryptfs_init_crypto</a> (void)</td></tr>
<tr class="separator:a00d0a5dfb857ae4cb4873001e6393d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22bc0a20db49562fe153dd763d2c583b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a22bc0a20db49562fe153dd763d2c583b">ecryptfs_destroy_crypto</a> (void)</td></tr>
<tr class="separator:a22bc0a20db49562fe153dd763d2c583b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41519bf356d367a394b8efb980ee6e51"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a41519bf356d367a394b8efb980ee6e51">ecryptfs_add_new_key_tfm</a> (struct <a class="el" href="structecryptfs__key__tfm.html">ecryptfs_key_tfm</a> **key_tfm, char *cipher_name, size_t key_size)</td></tr>
<tr class="separator:a41519bf356d367a394b8efb980ee6e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546635bf3080054059b6f8cef79ca4c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1">ecryptfs_tfm_exists</a> (char *cipher_name, struct <a class="el" href="structecryptfs__key__tfm.html">ecryptfs_key_tfm</a> **key_tfm)</td></tr>
<tr class="separator:a546635bf3080054059b6f8cef79ca4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af479d34da23aa4c6382373fdce1f7bbf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af479d34da23aa4c6382373fdce1f7bbf">ecryptfs_get_tfm_and_mutex_for_cipher_name</a> (struct crypto_blkcipher **tfm, struct mutex **tfm_mutex, char *cipher_name)</td></tr>
<tr class="separator:af479d34da23aa4c6382373fdce1f7bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71d7b139a135868e26dc349825743599"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a71d7b139a135868e26dc349825743599">ecryptfs_encode_for_filename</a> (unsigned char *dst, size_t *dst_size, unsigned char *src, size_t src_size)</td></tr>
<tr class="separator:a71d7b139a135868e26dc349825743599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcbf6726b92e8d2c0523c8a73d29645b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abcbf6726b92e8d2c0523c8a73d29645b">ecryptfs_decode_from_filename</a> (unsigned char *dst, size_t *dst_size, const unsigned char *src, size_t src_size)</td></tr>
<tr class="separator:abcbf6726b92e8d2c0523c8a73d29645b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">: The plaintext name</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>ecryptfs_encrypt_and_encode_filename - converts a plaintext file name to cipher text : The crypt_stat struct associated with the file anem to encode</p>
<p>: The length of the plaintext : The encypted name</p>
<p>Encrypts and encodes a filename into something that constitutes a valid filename for a filesystem, with printable characters.</p>
<p>We assume that we have a properly initialized crypto context, pointed to by crypt_stat-&gt;tfm.</p>
<p>Returns zero on success; non-zero on otherwise </p>
</div></td></tr>
<tr class="memitem:ab06b8734f2f60f1d0e0a49cea38e4139"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab06b8734f2f60f1d0e0a49cea38e4139">ecryptfs_encrypt_and_encode_filename</a> (char **encoded_name, size_t *encoded_name_size, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat, const char *name, size_t name_size)</td></tr>
<tr class="separator:ab06b8734f2f60f1d0e0a49cea38e4139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">: The filename in cipher text</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>ecryptfs_decode_and_decrypt_filename - converts the encoded cipher text name to decoded plaintext : The plaintext name : The plaintext name size : eCryptfs directory dentry</p>
<p>: The cipher text name size</p>
<p>Decrypts and decodes the filename.</p>
<p>Returns zero on error; non-zero otherwise </p>
</div></td></tr>
<tr class="memitem:a003450260d7483c53860bb214791bda6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a003450260d7483c53860bb214791bda6">ecryptfs_decode_and_decrypt_filename</a> (char **plaintext_name, size_t *plaintext_name_size, struct dentry *ecryptfs_dir_dentry, const char *name, size_t name_size)</td></tr>
<tr class="separator:a003450260d7483c53860bb214791bda6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6da5421d6633b1751d57eb37c78fa822"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6da5421d6633b1751d57eb37c78fa822">fake_iv</a> [<a class="el" href="ecryptfs__kernel_8h.html#a916653fac2790272ac4c3fe28d111897">ECRYPTFS_MAX_IV_BYTES</a>]</td></tr>
<tr class="separator:a6da5421d6633b1751d57eb37c78fa822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5319c22af6992f27d2bd1f7fb9aaa639"><td class="memItemLeft" align="right" valign="top">static struct <br class="typebreak"/>
<a class="el" href="structecryptfs__flag__map__elem.html">ecryptfs_flag_map_elem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5319c22af6992f27d2bd1f7fb9aaa639">ecryptfs_flag_map</a> []</td></tr>
<tr class="separator:a5319c22af6992f27d2bd1f7fb9aaa639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f3bdb4acc333f1c6b712f86275fd5ca"><td class="memItemLeft" align="right" valign="top">static struct <br class="typebreak"/>
<a class="el" href="structecryptfs__cipher__code__str__map__elem.html">ecryptfs_cipher_code_str_map_elem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9f3bdb4acc333f1c6b712f86275fd5ca">ecryptfs_cipher_code_str_map</a> []</td></tr>
<tr class="separator:a9f3bdb4acc333f1c6b712f86275fd5ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9530ef94c35f4a3a133db1b7f89ba7"><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a4b9530ef94c35f4a3a133db1b7f89ba7">ecryptfs_header_cache_1</a></td></tr>
<tr class="separator:a4b9530ef94c35f4a3a133db1b7f89ba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af332c3f1c709eac519a4e0507188b93e"><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af332c3f1c709eac519a4e0507188b93e">ecryptfs_header_cache_2</a></td></tr>
<tr class="separator:af332c3f1c709eac519a4e0507188b93e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aa13d88e5e4790fd737d96db5a80b34"><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6aa13d88e5e4790fd737d96db5a80b34">ecryptfs_key_tfm_cache</a></td></tr>
<tr class="separator:a6aa13d88e5e4790fd737d96db5a80b34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1606c7dd8d7f89d2374af2373f03078"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlist__head.html">list_head</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae1606c7dd8d7f89d2374af2373f03078">key_tfm_list</a></td></tr>
<tr class="separator:ae1606c7dd8d7f89d2374af2373f03078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a102b127e075cb8e9aeb2886083755e55"><td class="memItemLeft" align="right" valign="top">struct mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a102b127e075cb8e9aeb2886083755e55">key_tfm_list_mutex</a></td></tr>
<tr class="separator:a102b127e075cb8e9aeb2886083755e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d2f9ce53be8c025337c78c0301793f"><td class="memItemLeft" align="right" valign="top">static unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a09d2f9ce53be8c025337c78c0301793f">portable_filename_chars</a></td></tr>
<tr class="separator:a09d2f9ce53be8c025337c78c0301793f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a027b889665529024b5d98c658da25ed3"><td class="memItemLeft" align="right" valign="top">static const unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a027b889665529024b5d98c658da25ed3">filename_rev_map</a> []</td></tr>
<tr class="separator:a027b889665529024b5d98c658da25ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a509e857b6cc1ef99c6b7cff012b4b5b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ECRYPTFS_DONT_VALIDATE_HEADER_SIZE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01653">1653</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a628468ef410c8d30feba27b5c6d9e77a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ECRYPTFS_MAX_SCATTERLIST_LEN&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00996">996</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a682465bf299e220de23b73a3f8e673e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ECRYPTFS_VALIDATE_HEADER_SIZE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01654">1654</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6351e3152155696288917740cc9c849d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int contains_ecryptfs_marker </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>contains_ecryptfs_marker - check for the ecryptfs marker : The data block in which to check</p>
<p>Returns one if marker found; zero if not found </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01270">1270</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a6351e3152155696288917740cc9c849d_icgraph.png" border="0" usemap="#crypto_8c_a6351e3152155696288917740cc9c849d_icgraph" alt=""/></div>
<map name="crypto_8c_a6351e3152155696288917740cc9c849d_icgraph" id="crypto_8c_a6351e3152155696288917740cc9c849d_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a1fe598009db325ac45c099f00a506eaf" title="ecryptfs_read_and_validate\l_header_region" alt="" coords="227,5,408,46"/><area shape="rect" id="node5" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="228,136,407,163"/><area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#ade462ad60d1c69a5246f7623f09374a1" title="ecryptfs_read_and_validate\l_xattr_region" alt="" coords="227,70,408,111"/><area shape="rect" id="node3" href="inode_8c.html#ad1f58d0fd3b46f3063934fe8f6513f45" title="ecryptfs_lookup_and\l_interpose_lower" alt="" coords="466,49,609,90"/><area shape="rect" id="node4" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="667,56,781,83"/><area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="456,136,619,163"/><area shape="rect" id="node7" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="672,121,776,148"/><area shape="rect" id="node8" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="667,172,781,199"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a70334db0e206d80e643be63f141a4ab9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int decrypt_scatterlist </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct scatterlist *&#160;</td>
          <td class="paramname"><em>dest_sg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct scatterlist *&#160;</td>
          <td class="paramname"><em>src_sg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>decrypt_scatterlist : Cryptographic context : The destination scatterlist to decrypt into : The source scatterlist to decrypt from : The number of bytes to decrypt : The initialization vector to use for the decryption</p>
<p>Returns the number of bytes decrypted; negative value on error </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00840">840</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a70334db0e206d80e643be63f141a4ab9_icgraph.png" border="0" usemap="#crypto_8c_a70334db0e206d80e643be63f141a4ab9_icgraph" alt=""/></div>
<map name="crypto_8c_a70334db0e206d80e643be63f141a4ab9_icgraph" id="crypto_8c_a70334db0e206d80e643be63f141a4ab9_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a8ebf9f9d953fc4f0f1e464ab16e9773d" title="ecryptfs_decrypt_pages" alt="" coords="387,5,549,32"/><area shape="rect" id="node4" href="crypto_8c.html#a78a26bcd3062c8d4780d955d563b4f69" title="ecryptfs_decrypt_page\l_offset" alt="" coords="184,57,339,98"/><area shape="rect" id="node3" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="992,31,1128,57"/><area shape="rect" id="node5" href="crypto_8c.html#af6d633b806e115227b076c421479e4ca" title="ecryptfs_decrypt_extent" alt="" coords="387,64,549,91"/><area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#a8f0e0486293ab97cca8219ee1fee7f4b" title="ecryptfs_decrypt_page" alt="" coords="597,64,752,91"/><area shape="rect" id="node7" href="mmap_8c.html#a8f8e487f41eae0bd59f0f73483c8b0bd" title="ecryptfs_readpage" alt="" coords="807,56,937,83"/><area shape="rect" id="node8" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="801,107,943,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a41519bf356d367a394b8efb980ee6e51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_add_new_key_tfm </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__key__tfm.html">ecryptfs_key_tfm</a> **&#160;</td>
          <td class="paramname"><em>key_tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cipher_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02060">2060</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a41519bf356d367a394b8efb980ee6e51_cgraph.png" border="0" usemap="#crypto_8c_a41519bf356d367a394b8efb980ee6e51_cgraph" alt=""/></div>
<map name="crypto_8c_a41519bf356d367a394b8efb980ee6e51_cgraph" id="crypto_8c_a41519bf356d367a394b8efb980ee6e51_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25" title="ecryptfs_process_key\l_cipher" alt="" coords="238,5,389,46"/><area shape="rect" id="node4" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="280,71,347,97"/><area shape="rect" id="node3" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="437,5,579,46"/><area shape="rect" id="node5" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="467,71,549,97"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a41519bf356d367a394b8efb980ee6e51_icgraph.png" border="0" usemap="#crypto_8c_a41519bf356d367a394b8efb980ee6e51_icgraph" alt=""/></div>
<map name="crypto_8c_a41519bf356d367a394b8efb980ee6e51_icgraph" id="crypto_8c_a41519bf356d367a394b8efb980ee6e51_icgraph">
<area shape="rect" id="node2" href="services_2gaes_2ecryptfs_2main_8c.html#ad2a806cb5b6290a55a1d14c514ac0590" title="ecryptfs_parse_options" alt="" coords="243,89,400,116"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="237,173,405,214"/><area shape="rect" id="node3" href="services_2gaes_2ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="481,56,593,83"/><area shape="rect" id="node5" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="473,107,602,149"/><area shape="rect" id="node10" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="471,173,604,214"/><area shape="rect" id="node17" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="454,239,621,281"/><area shape="rect" id="node23" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="470,307,605,333"/><area shape="rect" id="node6" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="671,112,846,139"/><area shape="rect" id="node7" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="915,49,1061,90"/><area shape="rect" id="node8" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="1153,5,1268,32"/><area shape="rect" id="node9" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1150,56,1271,83"/><area shape="rect" id="node11" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="685,166,832,207"/><area shape="rect" id="node12" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="937,121,1039,148"/><area shape="rect" id="node14" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="909,173,1067,200"/><area shape="rect" id="node13" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="1153,107,1268,133"/><area shape="rect" id="node15" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="1150,157,1271,184"/><area shape="rect" id="node16" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="1141,208,1281,235"/><area shape="rect" id="node18" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="669,247,848,273"/><area shape="rect" id="node19" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="899,253,1077,280"/><area shape="rect" id="node20" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1129,259,1292,285"/><area shape="rect" id="node21" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1363,208,1467,235"/><area shape="rect" id="node22" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1358,259,1471,285"/><area shape="rect" id="node24" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="681,299,836,341"/><area shape="rect" id="node25" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="897,309,1079,336"/><area shape="rect" id="node26" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="1128,309,1293,336"/><area shape="rect" id="node27" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1341,309,1488,336"/><area shape="rect" id="node28" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1536,309,1648,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afe9ebb3f8af0e14969d856f179bccc8d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_calculate_md5 </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_calculate_md5 - calculates the md5 of  : Pointer to 16 bytes of allocated memory : Pointer to crypt_stat struct for the current inode : Data to be md5'd : Length of </p>
<p>Uses the allocated crypto context that crypt_stat references to generate the MD5 sum of the contents of src. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00105">105</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_afe9ebb3f8af0e14969d856f179bccc8d_icgraph.png" border="0" usemap="#crypto_8c_afe9ebb3f8af0e14969d856f179bccc8d_icgraph" alt=""/></div>
<map name="crypto_8c_afe9ebb3f8af0e14969d856f179bccc8d_icgraph" id="crypto_8c_afe9ebb3f8af0e14969d856f179bccc8d_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#aa4738f6aeb7582859b83cdbc08285349" title="ecryptfs_derive_iv" alt="" coords="236,5,364,32"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a010c33619300979023e302badcdbd3b5" title="ecryptfs_compute_root_iv" alt="" coords="214,56,386,83"/><area shape="rect" id="node4" href="crypto_8c.html#a0bad7026cdc7157c2d78fda1c58b5789" title="ecryptfs_generate_new_key" alt="" coords="435,31,621,57"/><area shape="rect" id="node8" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="439,81,617,108"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="671,31,846,57"/><area shape="rect" id="node6" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="904,31,1051,57"/><area shape="rect" id="node7" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1108,31,1220,57"/><area shape="rect" id="node9" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="669,81,848,108"/><area shape="rect" id="node10" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="896,81,1059,108"/><area shape="rect" id="node11" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1112,81,1216,108"/><area shape="rect" id="node12" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1107,132,1221,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9ec4f1a07858b147d07a4691fccc9741"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_cipher_code_to_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="helper_8c.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td>
          <td class="paramname"><em>cipher_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_cipher_code_to_string : Destination to write out the cipher name : The code to convert to cipher name string</p>
<p>Returns zero on success </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01425">1425</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a9ec4f1a07858b147d07a4691fccc9741_icgraph.png" border="0" usemap="#crypto_8c_a9ec4f1a07858b147d07a4691fccc9741_icgraph" alt=""/></div>
<map name="crypto_8c_a9ec4f1a07858b147d07a4691fccc9741_icgraph" id="crypto_8c_a9ec4f1a07858b147d07a4691fccc9741_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="211,38,344,79"/><area shape="rect" id="node9" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="201,103,354,145"/><area shape="rect" id="node15" href="keystore_8c.html#a32c87c3d9f5f82f8e86006f94b9130d3" title="parse_tag_3_packet" alt="" coords="208,169,347,196"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="419,38,565,79"/><area shape="rect" id="node4" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="667,5,770,32"/><area shape="rect" id="node6" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="639,56,798,83"/><area shape="rect" id="node5" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="880,5,995,32"/><area shape="rect" id="node7" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="877,56,998,83"/><area shape="rect" id="node8" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="867,107,1007,133"/><area shape="rect" id="node10" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="403,163,581,189"/><area shape="rect" id="node11" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="629,163,808,189"/><area shape="rect" id="node12" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="856,163,1019,189"/><area shape="rect" id="node13" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1072,137,1176,164"/><area shape="rect" id="node14" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1067,188,1181,215"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abac276c0609493e5a5bf8c1c78223877"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="helper_8c.html#aed742c436da53c1080638ce6ef7d13de">u8</a> ecryptfs_code_for_cipher_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cipher_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_code_for_cipher_string : The string alias for the cipher : Length of key in bytes; used for AES code selection</p>
<p>Returns zero on no match, or the cipher code on match </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01390">1390</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_abac276c0609493e5a5bf8c1c78223877_icgraph.png" border="0" usemap="#crypto_8c_abac276c0609493e5a5bf8c1c78223877_icgraph" alt=""/></div>
<map name="crypto_8c_abac276c0609493e5a5bf8c1c78223877_icgraph" id="crypto_8c_abac276c0609493e5a5bf8c1c78223877_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="242,33,371,74"/><area shape="rect" id="node7" href="keystore_8c.html#a2bfafae46d434c6ccc87ec04ee2e9db4" title="pki_encrypt_session_key" alt="" coords="222,99,391,125"/><area shape="rect" id="node14" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="461,149,595,176"/><area shape="rect" id="node3" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="441,40,615,67"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="668,33,815,74"/><area shape="rect" id="node5" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="901,5,1016,32"/><area shape="rect" id="node6" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="898,56,1019,83"/><area shape="rect" id="node8" href="keystore_8c.html#ac6bc314de94c6d266926cc7dc0219c5b" title="write_tag_1_packet" alt="" coords="461,99,595,125"/><area shape="rect" id="node9" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="664,115,819,157"/><area shape="rect" id="node10" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="867,123,1050,149"/><area shape="rect" id="node11" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="1099,123,1264,149"/><area shape="rect" id="node12" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1312,123,1459,149"/><area shape="rect" id="node13" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1507,123,1619,149"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a010c33619300979023e302badcdbd3b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_compute_root_iv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_compute_root_iv </p>
<p>On error, sets the root IV to all 0's. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01089">1089</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a010c33619300979023e302badcdbd3b5_cgraph.png" border="0" usemap="#crypto_8c_a010c33619300979023e302badcdbd3b5_cgraph" alt=""/></div>
<map name="crypto_8c_a010c33619300979023e302badcdbd3b5_cgraph" id="crypto_8c_a010c33619300979023e302badcdbd3b5_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#afe9ebb3f8af0e14969d856f179bccc8d" title="ecryptfs_calculate_md5" alt="" coords="227,5,387,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a010c33619300979023e302badcdbd3b5_icgraph.png" border="0" usemap="#crypto_8c_a010c33619300979023e302badcdbd3b5_icgraph" alt=""/></div>
<map name="crypto_8c_a010c33619300979023e302badcdbd3b5_icgraph" id="crypto_8c_a010c33619300979023e302badcdbd3b5_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a0bad7026cdc7157c2d78fda1c58b5789" title="ecryptfs_generate_new_key" alt="" coords="227,5,413,32"/><area shape="rect" id="node6" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="231,56,409,83"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="463,5,638,32"/><area shape="rect" id="node4" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="696,5,843,32"/><area shape="rect" id="node5" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="900,5,1012,32"/><area shape="rect" id="node7" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="461,56,640,83"/><area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="688,56,851,83"/><area shape="rect" id="node9" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="904,56,1008,83"/><area shape="rect" id="node10" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="899,107,1013,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3ab2be85b67e070ec5d18d375068a9af"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_copy_filename </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>copied_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>copied_name_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>name_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01951">1951</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a3ab2be85b67e070ec5d18d375068a9af_icgraph.png" border="0" usemap="#crypto_8c_a3ab2be85b67e070ec5d18d375068a9af_icgraph" alt=""/></div>
<map name="crypto_8c_a3ab2be85b67e070ec5d18d375068a9af_icgraph" id="crypto_8c_a3ab2be85b67e070ec5d18d375068a9af_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="213,45,360,86"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="213,110,360,151"/><area shape="rect" id="node3" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="431,5,545,32"/><area shape="rect" id="node4" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="427,56,549,83"/><area shape="rect" id="node6" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="437,113,539,140"/><area shape="rect" id="node8" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="409,164,567,191"/><area shape="rect" id="node7" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="629,113,744,140"/><area shape="rect" id="node9" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="626,164,747,191"/><area shape="rect" id="node10" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="617,215,757,241"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4c1f20c33cc83c9fae00176557a101d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ecryptfs_copy_mount_wide_flags_to_inode_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_copy_mount_wide_flags_to_inode_flags : The inode's cryptographic context : The mount point's cryptographic context</p>
<p>This function propagates the mount-wide flags to individual inode flags. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01138">1138</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a4c1f20c33cc83c9fae00176557a101d2_icgraph.png" border="0" usemap="#crypto_8c_a4c1f20c33cc83c9fae00176557a101d2_icgraph" alt=""/></div>
<map name="crypto_8c_a4c1f20c33cc83c9fae00176557a101d2_icgraph" id="crypto_8c_a4c1f20c33cc83c9fae00176557a101d2_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a43a35c67336e7e2dc9545638ffedda7e" title="ecryptfs_set_default\l_crypt_stat_vals" alt="" coords="249,5,389,46"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="449,29,623,56"/><area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="237,121,400,148"/><area shape="rect" id="node4" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="672,29,819,56"/><area shape="rect" id="node5" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="867,29,979,56"/><area shape="rect" id="node7" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="484,96,588,123"/><area shape="rect" id="node8" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="479,147,593,173"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a81000f6bbd25c79214005d46daa3d6ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_copy_mount_wide_sigs_to_inode_sigs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01157">1157</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a81000f6bbd25c79214005d46daa3d6ca_cgraph.png" border="0" usemap="#crypto_8c_a81000f6bbd25c79214005d46daa3d6ca_cgraph" alt=""/></div>
<map name="crypto_8c_a81000f6bbd25c79214005d46daa3d6ca_cgraph" id="crypto_8c_a81000f6bbd25c79214005d46daa3d6ca_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#acac9a69d1ef9650a4dc86067d4632c41" title="ecryptfs_add_keysig" alt="" coords="230,12,373,39"/><area shape="rect" id="node3" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="421,12,488,39"/><area shape="rect" id="node4" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="537,12,618,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a81000f6bbd25c79214005d46daa3d6ca_icgraph.png" border="0" usemap="#crypto_8c_a81000f6bbd25c79214005d46daa3d6ca_icgraph" alt=""/></div>
<map name="crypto_8c_a81000f6bbd25c79214005d46daa3d6ca_icgraph" id="crypto_8c_a81000f6bbd25c79214005d46daa3d6ca_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="230,12,405,39"/><area shape="rect" id="node3" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="453,12,600,39"/><area shape="rect" id="node4" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="648,12,760,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5901e51bc8f4d9b71eb0c0692e483b6f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_crypto_api_algify_cipher_name </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>algified_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cipher_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>chaining_modifier</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00156">156</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a5901e51bc8f4d9b71eb0c0692e483b6f_icgraph.png" border="0" usemap="#crypto_8c_a5901e51bc8f4d9b71eb0c0692e483b6f_icgraph" alt=""/></div>
<map name="crypto_8c_a5901e51bc8f4d9b71eb0c0692e483b6f_icgraph" id="crypto_8c_a5901e51bc8f4d9b71eb0c0692e483b6f_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#aa6806b87a57ada237cc52b391b0b70dc" title="ecryptfs_init_crypt_ctx" alt="" coords="633,61,788,88"/><area shape="rect" id="node12" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25" title="ecryptfs_process_key\l_cipher" alt="" coords="195,129,346,170"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="1061,128,1235,155"/><area shape="rect" id="node6" href="keystore_8c.html#a32c87c3d9f5f82f8e86006f94b9130d3" title="parse_tag_3_packet" alt="" coords="857,5,996,32"/><area shape="rect" id="node7" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="1059,56,1237,83"/><area shape="rect" id="node4" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1731,169,1877,196"/><area shape="rect" id="node5" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1925,169,2037,196"/><area shape="rect" id="node8" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="1288,56,1467,83"/><area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1519,56,1681,83"/><area shape="rect" id="node10" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1752,81,1856,108"/><area shape="rect" id="node11" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1747,31,1861,57"/><area shape="rect" id="node13" href="ecryptfs__kernel_8h.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="395,157,578,184"/><area shape="rect" id="node14" href="services_2gaes_2ecryptfs_2main_8c.html#ad2a806cb5b6290a55a1d14c514ac0590" title="ecryptfs_parse_options" alt="" coords="632,157,789,184"/><area shape="rect" id="node16" href="ecryptfs__kernel_8h.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="627,267,795,309"/><area shape="rect" id="node15" href="services_2gaes_2ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="871,157,983,184"/><area shape="rect" id="node17" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="862,326,991,367"/><area shape="rect" id="node22" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="860,409,993,450"/><area shape="rect" id="node29" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="843,209,1010,250"/><area shape="rect" id="node30" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="859,275,994,301"/><area shape="rect" id="node18" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="1061,329,1235,356"/><area shape="rect" id="node19" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="1304,319,1451,361"/><area shape="rect" id="node20" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="1543,327,1657,353"/><area shape="rect" id="node21" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1539,276,1661,303"/><area shape="rect" id="node23" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="1075,418,1221,459"/><area shape="rect" id="node24" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="1326,477,1429,504"/><area shape="rect" id="node26" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="1298,425,1457,452"/><area shape="rect" id="node25" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="1543,479,1657,505"/><area shape="rect" id="node27" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="1539,428,1661,455"/><area shape="rect" id="node28" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="1530,377,1670,404"/><area shape="rect" id="node31" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="1071,197,1225,238"/><area shape="rect" id="node32" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="1286,200,1469,227"/><area shape="rect" id="node33" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="1517,197,1683,224"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a003450260d7483c53860bb214791bda6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_decode_and_decrypt_filename </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>plaintext_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>plaintext_name_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dir_dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>name_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02441">2441</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a003450260d7483c53860bb214791bda6_cgraph.png" border="0" usemap="#crypto_8c_a003450260d7483c53860bb214791bda6_cgraph" alt=""/></div>
<map name="crypto_8c_a003450260d7483c53860bb214791bda6_cgraph" id="crypto_8c_a003450260d7483c53860bb214791bda6_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ab0987a55f9bd100b72e69f9dc54d1e39" title="ecryptfs_superblock\l_to_private" alt="" coords="211,25,349,66"/><area shape="rect" id="node3" href="crypto_8c.html#abcbf6726b92e8d2c0523c8a73d29645b" title="ecryptfs_decode_from\l_filename" alt="" coords="205,90,355,131"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="213,155,347,197"/><area shape="rect" id="node22" href="crypto_8c.html#a3ab2be85b67e070ec5d18d375068a9af" title="ecryptfs_copy_filename" alt="" coords="200,221,360,248"/><area shape="rect" id="node5" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="415,5,569,46"/><area shape="rect" id="node6" href="crypto_8c.html#a600a433968f0fca6c59d0503e4a13adc" title="ecryptfs_to_hex" alt="" coords="435,71,549,97"/><area shape="rect" id="node7" href="crypto_8c.html#a9ec4f1a07858b147d07a4691fccc9741" title="ecryptfs_cipher_code\l_to_string" alt="" coords="419,122,565,163"/><area shape="rect" id="node8" href="crypto_8c.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="408,187,576,229"/><area shape="rect" id="node15" href="crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="431,253,553,280"/><area shape="rect" id="node16" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="427,305,557,346"/><area shape="rect" id="node9" href="crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="647,164,785,191"/><area shape="rect" id="node10" href="crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="625,215,807,241"/><area shape="rect" id="node11" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25" title="ecryptfs_process_key\l_cipher" alt="" coords="885,169,1035,210"/><area shape="rect" id="node13" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="927,235,993,261"/><area shape="rect" id="node12" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="1112,169,1253,210"/><area shape="rect" id="node14" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="1142,235,1223,261"/><area shape="rect" id="node17" href="keystore_8c.html#a2a70f7a5ff64535e0cb220b179e1982f" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="647,283,785,325"/><area shape="rect" id="node18" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="641,349,791,390"/><area shape="rect" id="node19" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="876,305,1044,332"/><area shape="rect" id="node20" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="857,356,1063,383"/><area shape="rect" id="node21" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="881,407,1039,433"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a003450260d7483c53860bb214791bda6_icgraph.png" border="0" usemap="#crypto_8c_a003450260d7483c53860bb214791bda6_icgraph" alt=""/></div>
<map name="crypto_8c_a003450260d7483c53860bb214791bda6_icgraph" id="crypto_8c_a003450260d7483c53860bb214791bda6_icgraph">
<area shape="rect" id="node2" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="229,5,331,32"/><area shape="rect" id="node4" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="201,56,359,83"/><area shape="rect" id="node3" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="421,5,536,32"/><area shape="rect" id="node5" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="418,56,539,83"/><area shape="rect" id="node6" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="409,107,549,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abcbf6726b92e8d2c0523c8a73d29645b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ecryptfs_decode_from_filename </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>dst_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>src_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_decode_from_filename : If NULL, this function only sets  and returns. If non-NULL, this function decodes the encoded octets in  into the memory that  points to. : Set to the size of the decoded string. : The encoded set of octets to decode. : The size of the encoded set of octets to decode. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02263">2263</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_abcbf6726b92e8d2c0523c8a73d29645b_icgraph.png" border="0" usemap="#crypto_8c_abcbf6726b92e8d2c0523c8a73d29645b_icgraph" alt=""/></div>
<map name="crypto_8c_abcbf6726b92e8d2c0523c8a73d29645b_icgraph" id="crypto_8c_abcbf6726b92e8d2c0523c8a73d29645b_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="205,23,352,65"/><area shape="rect" id="node3" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="429,5,531,32"/><area shape="rect" id="node5" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="401,56,559,83"/><area shape="rect" id="node4" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="621,5,736,32"/><area shape="rect" id="node6" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="618,56,739,83"/><area shape="rect" id="node7" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="609,107,749,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af6d633b806e115227b076c421479e4ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_decrypt_extent </td>
          <td>(</td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>enc_extent_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>extent_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00700">700</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_af6d633b806e115227b076c421479e4ca_cgraph.png" border="0" usemap="#crypto_8c_af6d633b806e115227b076c421479e4ca_cgraph" alt=""/></div>
<map name="crypto_8c_af6d633b806e115227b076c421479e4ca_cgraph" id="crypto_8c_af6d633b806e115227b076c421479e4ca_cgraph">
<area shape="rect" id="node2" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="225,5,361,32"/><area shape="rect" id="node3" href="crypto_8c.html#a78a26bcd3062c8d4780d955d563b4f69" title="ecryptfs_decrypt_page\l_offset" alt="" coords="216,57,371,98"/><area shape="rect" id="node4" href="crypto_8c.html#a70334db0e206d80e643be63f141a4ab9" title="decrypt_scatterlist" alt="" coords="419,64,549,91"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_af6d633b806e115227b076c421479e4ca_icgraph.png" border="0" usemap="#crypto_8c_af6d633b806e115227b076c421479e4ca_icgraph" alt=""/></div>
<map name="crypto_8c_af6d633b806e115227b076c421479e4ca_icgraph" id="crypto_8c_af6d633b806e115227b076c421479e4ca_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a8f0e0486293ab97cca8219ee1fee7f4b" title="ecryptfs_decrypt_page" alt="" coords="216,31,371,57"/><area shape="rect" id="node3" href="mmap_8c.html#a8f8e487f41eae0bd59f0f73483c8b0bd" title="ecryptfs_readpage" alt="" coords="426,5,555,32"/><area shape="rect" id="node5" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="419,56,562,83"/><area shape="rect" id="node4" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="611,5,747,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8f0e0486293ab97cca8219ee1fee7f4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_decrypt_page </td>
          <td>(</td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00774">774</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a8f0e0486293ab97cca8219ee1fee7f4b_cgraph.png" border="0" usemap="#crypto_8c_a8f0e0486293ab97cca8219ee1fee7f4b_cgraph" alt=""/></div>
<map name="crypto_8c_a8f0e0486293ab97cca8219ee1fee7f4b_cgraph" id="crypto_8c_a8f0e0486293ab97cca8219ee1fee7f4b_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="425,5,596,32"/><area shape="rect" id="node3" href="crypto_8c.html#a740d9efeadec638412712e946d489058" title="ecryptfs_lower_offset\l_for_extent" alt="" coords="216,82,363,123"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a7a8f9447eb75e1878c99de4166fdd6fb" title="ecryptfs_read_lower" alt="" coords="220,31,359,57"/><area shape="rect" id="node6" href="crypto_8c.html#af6d633b806e115227b076c421479e4ca" title="ecryptfs_decrypt_extent" alt="" coords="208,148,371,175"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#ab2813066482c96f346fbf23e1eba0d8f" title="ecryptfs_lower_header_size" alt="" coords="419,89,603,116"/><area shape="rect" id="node7" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="443,144,579,171"/><area shape="rect" id="node8" href="crypto_8c.html#a78a26bcd3062c8d4780d955d563b4f69" title="ecryptfs_decrypt_page\l_offset" alt="" coords="433,195,588,237"/><area shape="rect" id="node9" href="crypto_8c.html#a70334db0e206d80e643be63f141a4ab9" title="decrypt_scatterlist" alt="" coords="651,203,781,229"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a8f0e0486293ab97cca8219ee1fee7f4b_icgraph.png" border="0" usemap="#crypto_8c_a8f0e0486293ab97cca8219ee1fee7f4b_icgraph" alt=""/></div>
<map name="crypto_8c_a8f0e0486293ab97cca8219ee1fee7f4b_icgraph" id="crypto_8c_a8f0e0486293ab97cca8219ee1fee7f4b_icgraph">
<area shape="rect" id="node2" href="mmap_8c.html#a8f8e487f41eae0bd59f0f73483c8b0bd" title="ecryptfs_readpage" alt="" coords="215,5,345,32"/><area shape="rect" id="node4" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="209,56,351,83"/><area shape="rect" id="node3" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="400,5,536,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a78a26bcd3062c8d4780d955d563b4f69"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_decrypt_page_offset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>dst_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dst_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>src_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>src_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_decrypt_page_offset : The cryptographic context : The page to decrypt into : The offset in the page to decrypt into : The page to decrypt from : The offset in the page to decrypt from : The number of bytes to decrypt : The initialization vector to use for the decryption</p>
<p>Returns the number of bytes decrypted </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00980">980</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a78a26bcd3062c8d4780d955d563b4f69_cgraph.png" border="0" usemap="#crypto_8c_a78a26bcd3062c8d4780d955d563b4f69_cgraph" alt=""/></div>
<map name="crypto_8c_a78a26bcd3062c8d4780d955d563b4f69_cgraph" id="crypto_8c_a78a26bcd3062c8d4780d955d563b4f69_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a70334db0e206d80e643be63f141a4ab9" title="decrypt_scatterlist" alt="" coords="209,12,338,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a78a26bcd3062c8d4780d955d563b4f69_icgraph.png" border="0" usemap="#crypto_8c_a78a26bcd3062c8d4780d955d563b4f69_icgraph" alt=""/></div>
<map name="crypto_8c_a78a26bcd3062c8d4780d955d563b4f69_icgraph" id="crypto_8c_a78a26bcd3062c8d4780d955d563b4f69_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#af6d633b806e115227b076c421479e4ca" title="ecryptfs_decrypt_extent" alt="" coords="208,31,371,57"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a8f0e0486293ab97cca8219ee1fee7f4b" title="ecryptfs_decrypt_page" alt="" coords="419,31,573,57"/><area shape="rect" id="node4" href="mmap_8c.html#a8f8e487f41eae0bd59f0f73483c8b0bd" title="ecryptfs_readpage" alt="" coords="629,5,758,32"/><area shape="rect" id="node6" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="622,56,765,83"/><area shape="rect" id="node5" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="813,5,949,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8ebf9f9d953fc4f0f1e464ab16e9773d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_decrypt_pages </td>
          <td>(</td>
          <td class="paramtype">struct page **&#160;</td>
          <td class="paramname"><em>pgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nr_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00882">882</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a8ebf9f9d953fc4f0f1e464ab16e9773d_cgraph.png" border="0" usemap="#crypto_8c_a8ebf9f9d953fc4f0f1e464ab16e9773d_cgraph" alt=""/></div>
<map name="crypto_8c_a8ebf9f9d953fc4f0f1e464ab16e9773d_cgraph" id="crypto_8c_a8ebf9f9d953fc4f0f1e464ab16e9773d_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="448,25,619,52"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#ab2813066482c96f346fbf23e1eba0d8f" title="ecryptfs_lower_header_size" alt="" coords="216,25,400,52"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a7a8f9447eb75e1878c99de4166fdd6fb" title="ecryptfs_read_lower" alt="" coords="239,76,377,103"/><area shape="rect" id="node5" href="crypto_8c.html#a70334db0e206d80e643be63f141a4ab9" title="decrypt_scatterlist" alt="" coords="243,127,373,153"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a8ebf9f9d953fc4f0f1e464ab16e9773d_icgraph.png" border="0" usemap="#crypto_8c_a8ebf9f9d953fc4f0f1e464ab16e9773d_icgraph" alt=""/></div>
<map name="crypto_8c_a8ebf9f9d953fc4f0f1e464ab16e9773d_icgraph" id="crypto_8c_a8ebf9f9d953fc4f0f1e464ab16e9773d_icgraph">
<area shape="rect" id="node2" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="216,5,352,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa4738f6aeb7582859b83cdbc08285349"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_derive_iv </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_derive_iv : destination for the derived iv vale : Pointer to crypt_stat struct for the current inode : Offset of the extent whose IV we are to derive</p>
<p>Generate the initialization vector from the given root IV and page offset.</p>
<p>Returns zero on success; non-zero on error. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00189">189</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_aa4738f6aeb7582859b83cdbc08285349_cgraph.png" border="0" usemap="#crypto_8c_aa4738f6aeb7582859b83cdbc08285349_cgraph" alt=""/></div>
<map name="crypto_8c_aa4738f6aeb7582859b83cdbc08285349_cgraph" id="crypto_8c_aa4738f6aeb7582859b83cdbc08285349_cgraph">
<area shape="rect" id="node2" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="193,5,329,32"/><area shape="rect" id="node3" href="crypto_8c.html#afe9ebb3f8af0e14969d856f179bccc8d" title="ecryptfs_calculate_md5" alt="" coords="181,56,341,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a83389a63b87e4af4d99cd464dae97beb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_destroy_crypt_stat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_destroy_crypt_stat : Pointer to the crypt_stat struct to initialize.</p>
<p>Releases all memory associated with a crypt_stat struct. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00251">251</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a83389a63b87e4af4d99cd464dae97beb_cgraph.png" border="0" usemap="#crypto_8c_a83389a63b87e4af4d99cd464dae97beb_cgraph" alt=""/></div>
<map name="crypto_8c_a83389a63b87e4af4d99cd464dae97beb_cgraph" id="crypto_8c_a83389a63b87e4af4d99cd464dae97beb_cgraph">
<area shape="rect" id="node2" href="list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title="list_del" alt="" coords="238,5,301,32"/><area shape="rect" id="node3" href="list_8h.html#a24b474717d65a296695e8b79b4adefda" title="__list_del" alt="" coords="349,5,427,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a83389a63b87e4af4d99cd464dae97beb_icgraph.png" border="0" usemap="#crypto_8c_a83389a63b87e4af4d99cd464dae97beb_icgraph" alt=""/></div>
<map name="crypto_8c_a83389a63b87e4af4d99cd464dae97beb_icgraph" id="crypto_8c_a83389a63b87e4af4d99cd464dae97beb_icgraph">
<area shape="rect" id="node2" href="super_8c.html#ad5a4159ae57d350347e5223a6fb56b71" title="ecryptfs_destroy_inode" alt="" coords="237,5,395,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a22bc0a20db49562fe153dd763d2c583b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_destroy_crypto </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_destroy_crypto - free all cached key_tfms on key_tfm_list</p>
<p>Called only at module unload time </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02043">2043</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a22bc0a20db49562fe153dd763d2c583b_cgraph.png" border="0" usemap="#crypto_8c_a22bc0a20db49562fe153dd763d2c583b_cgraph" alt=""/></div>
<map name="crypto_8c_a22bc0a20db49562fe153dd763d2c583b_cgraph" id="crypto_8c_a22bc0a20db49562fe153dd763d2c583b_cgraph">
<area shape="rect" id="node2" href="list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title="list_del" alt="" coords="217,5,279,32"/><area shape="rect" id="node3" href="list_8h.html#a24b474717d65a296695e8b79b4adefda" title="__list_del" alt="" coords="328,5,405,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a22bc0a20db49562fe153dd763d2c583b_icgraph.png" border="0" usemap="#crypto_8c_a22bc0a20db49562fe153dd763d2c583b_icgraph" alt=""/></div>
<map name="crypto_8c_a22bc0a20db49562fe153dd763d2c583b_icgraph" id="crypto_8c_a22bc0a20db49562fe153dd763d2c583b_icgraph">
<area shape="rect" id="node2" href="services_2gaes_2ecryptfs_2main_8c.html#aa32ace6b7c319adb175778c357041568" title="ecryptfs_exit" alt="" coords="217,5,314,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a51353a78eb90d12fba6d671d2e76896c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_destroy_mount_crypt_stat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00267">267</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a51353a78eb90d12fba6d671d2e76896c_cgraph.png" border="0" usemap="#crypto_8c_a51353a78eb90d12fba6d671d2e76896c_cgraph" alt=""/></div>
<map name="crypto_8c_a51353a78eb90d12fba6d671d2e76896c_cgraph" id="crypto_8c_a51353a78eb90d12fba6d671d2e76896c_cgraph">
<area shape="rect" id="node2" href="list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title="list_del" alt="" coords="217,12,279,39"/><area shape="rect" id="node3" href="list_8h.html#a24b474717d65a296695e8b79b4adefda" title="__list_del" alt="" coords="328,12,405,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a51353a78eb90d12fba6d671d2e76896c_icgraph.png" border="0" usemap="#crypto_8c_a51353a78eb90d12fba6d671d2e76896c_icgraph" alt=""/></div>
<map name="crypto_8c_a51353a78eb90d12fba6d671d2e76896c_icgraph" id="crypto_8c_a51353a78eb90d12fba6d671d2e76896c_icgraph">
<area shape="rect" id="node2" href="services_2gaes_2ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="225,5,337,32"/><area shape="rect" id="node3" href="services_2gaes_2ecryptfs_2main_8c.html#afc526befd9b281d81555e8ee7f643d6e" title="ecryptfs_kill_block\l_super" alt="" coords="216,57,347,98"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a71d7b139a135868e26dc349825743599"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_encode_for_filename </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>dst_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>src_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_encode_for_filename : Destination location for encoded filename : Size of the encoded filename in bytes : Source location for the filename to encode : Size of the source in bytes </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02198">2198</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a71d7b139a135868e26dc349825743599_icgraph.png" border="0" usemap="#crypto_8c_a71d7b139a135868e26dc349825743599_icgraph" alt=""/></div>
<map name="crypto_8c_a71d7b139a135868e26dc349825743599_icgraph" id="crypto_8c_a71d7b139a135868e26dc349825743599_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="195,23,341,65"/><area shape="rect" id="node3" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="393,5,508,32"/><area shape="rect" id="node4" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="390,56,511,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab06b8734f2f60f1d0e0a49cea38e4139"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_encrypt_and_encode_filename </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>encoded_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>encoded_name_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>name_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02328">2328</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ab06b8734f2f60f1d0e0a49cea38e4139_cgraph.png" border="0" usemap="#crypto_8c_ab06b8734f2f60f1d0e0a49cea38e4139_cgraph" alt=""/></div>
<map name="crypto_8c_ab06b8734f2f60f1d0e0a49cea38e4139_cgraph" id="crypto_8c_ab06b8734f2f60f1d0e0a49cea38e4139_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="201,184,375,211"/><area shape="rect" id="node21" href="crypto_8c.html#a71d7b139a135868e26dc349825743599" title="ecryptfs_encode_for\l_filename" alt="" coords="218,235,358,277"/><area shape="rect" id="node22" href="crypto_8c.html#a3ab2be85b67e070ec5d18d375068a9af" title="ecryptfs_copy_filename" alt="" coords="208,301,368,328"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="425,177,554,218"/><area shape="rect" id="node4" href="crypto_8c.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="603,23,771,65"/><area shape="rect" id="node11" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="611,89,762,130"/><area shape="rect" id="node12" href="crypto_8c.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="621,155,752,181"/><area shape="rect" id="node13" href="crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="603,206,771,247"/><area shape="rect" id="node14" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="622,271,751,313"/><area shape="rect" id="node20" href="crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="625,337,748,364"/><area shape="rect" id="node5" href="crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="842,5,979,32"/><area shape="rect" id="node6" href="crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="819,56,1002,83"/><area shape="rect" id="node7" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25" title="ecryptfs_process_key\l_cipher" alt="" coords="1079,19,1230,61"/><area shape="rect" id="node9" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="1121,85,1188,112"/><area shape="rect" id="node8" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="1307,19,1448,61"/><area shape="rect" id="node10" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="1337,85,1418,112"/><area shape="rect" id="node15" href="keystore_8c.html#a2a70f7a5ff64535e0cb220b179e1982f" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="841,238,980,279"/><area shape="rect" id="node16" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="835,303,986,345"/><area shape="rect" id="node17" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="1071,260,1239,287"/><area shape="rect" id="node18" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="1051,311,1258,337"/><area shape="rect" id="node19" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="1076,361,1233,388"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ab06b8734f2f60f1d0e0a49cea38e4139_icgraph.png" border="0" usemap="#crypto_8c_ab06b8734f2f60f1d0e0a49cea38e4139_icgraph" alt=""/></div>
<map name="crypto_8c_ab06b8734f2f60f1d0e0a49cea38e4139_icgraph" id="crypto_8c_ab06b8734f2f60f1d0e0a49cea38e4139_icgraph">
<area shape="rect" id="node2" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="204,5,319,32"/><area shape="rect" id="node3" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="201,56,322,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a667352484e3769a93d4d6756207a6294"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_encrypt_extent </td>
          <td>(</td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>enc_extent_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>extent_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00412">412</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a667352484e3769a93d4d6756207a6294_cgraph.png" border="0" usemap="#crypto_8c_a667352484e3769a93d4d6756207a6294_cgraph" alt=""/></div>
<map name="crypto_8c_a667352484e3769a93d4d6756207a6294_cgraph" id="crypto_8c_a667352484e3769a93d4d6756207a6294_cgraph">
<area shape="rect" id="node2" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="597,5,733,32"/><area shape="rect" id="node3" href="crypto_8c.html#a4edeaa3bc6ab6aaf996f7a8c002c74a1" title="ecryptfs_encrypt_page\l_offset" alt="" coords="216,29,371,70"/><area shape="rect" id="node4" href="crypto_8c.html#a2557a0d17ec106c3b524579a1a68c17b" title="encrypt_scatterlist" alt="" coords="419,32,549,59"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a667352484e3769a93d4d6756207a6294_icgraph.png" border="0" usemap="#crypto_8c_a667352484e3769a93d4d6756207a6294_icgraph" alt=""/></div>
<map name="crypto_8c_a667352484e3769a93d4d6756207a6294_icgraph" id="crypto_8c_a667352484e3769a93d4d6756207a6294_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a26de129ca477fc9762d6750b5020914f" title="ecryptfs_encrypt_page" alt="" coords="216,56,371,83"/><area shape="rect" id="node3" href="mmap_8c.html#a1c709c67cbb144bffe29cff5a7ac0f8c" title="ecryptfs_writepage" alt="" coords="419,5,551,32"/><area shape="rect" id="node4" href="mmap_8c.html#aba2c17cca4323636c254626963421f3f" title="ecryptfs_write_end" alt="" coords="419,56,551,83"/><area shape="rect" id="node5" href="read__write_8c.html#a1f6fb7e71433ccea976b2cba69741f2a" title="ecryptfs_write" alt="" coords="433,107,537,133"/><area shape="rect" id="node6" href="inode_8c.html#a01b49555f54fc75f2ce9382cee60155e" title="grow_file" alt="" coords="617,81,692,108"/><area shape="rect" id="node9" href="inode_8c.html#a6d535560db4f881686903ff564b74faf" title="truncate_upper" alt="" coords="601,132,709,159"/><area shape="rect" id="node7" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="757,81,904,108"/><area shape="rect" id="node8" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="968,81,1080,108"/><area shape="rect" id="node10" href="inode_8c.html#ae6d4593f3f6d169ca3ecc1a07550cec1" title="ecryptfs_truncate" alt="" coords="769,132,892,159"/><area shape="rect" id="node12" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="774,183,887,209"/><area shape="rect" id="node11" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="953,132,1095,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac05661b742322849b06256613c2ee205"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_encrypt_filename </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__filename.html">ecryptfs_filename</a> *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_encrypt_filename - encrypt filename</p>
<p>CBC-encrypts the filename. We do not want to encrypt the same filename with the same key and IV, which may happen with hard links, so we prepend random bits to each filename.</p>
<p>Returns zero on success; non-zero otherwise </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01889">1889</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ac05661b742322849b06256613c2ee205_cgraph.png" border="0" usemap="#crypto_8c_ac05661b742322849b06256613c2ee205_cgraph" alt=""/></div>
<map name="crypto_8c_ac05661b742322849b06256613c2ee205_cgraph" id="crypto_8c_ac05661b742322849b06256613c2ee205_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="230,177,359,218"/><area shape="rect" id="node3" href="crypto_8c.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="408,23,576,65"/><area shape="rect" id="node10" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="417,89,567,130"/><area shape="rect" id="node11" href="crypto_8c.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="427,155,557,181"/><area shape="rect" id="node12" href="crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="408,206,576,247"/><area shape="rect" id="node13" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="427,271,557,313"/><area shape="rect" id="node19" href="crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="431,337,553,364"/><area shape="rect" id="node4" href="crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="647,5,785,32"/><area shape="rect" id="node5" href="crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="625,56,807,83"/><area shape="rect" id="node6" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25" title="ecryptfs_process_key\l_cipher" alt="" coords="885,19,1035,61"/><area shape="rect" id="node8" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="927,85,993,112"/><area shape="rect" id="node7" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="1112,19,1253,61"/><area shape="rect" id="node9" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="1142,85,1223,112"/><area shape="rect" id="node14" href="keystore_8c.html#a2a70f7a5ff64535e0cb220b179e1982f" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="647,238,785,279"/><area shape="rect" id="node15" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="641,303,791,345"/><area shape="rect" id="node16" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="876,260,1044,287"/><area shape="rect" id="node17" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="857,311,1063,337"/><area shape="rect" id="node18" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="881,361,1039,388"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ac05661b742322849b06256613c2ee205_icgraph.png" border="0" usemap="#crypto_8c_ac05661b742322849b06256613c2ee205_icgraph" alt=""/></div>
<map name="crypto_8c_ac05661b742322849b06256613c2ee205_icgraph" id="crypto_8c_ac05661b742322849b06256613c2ee205_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="229,23,376,65"/><area shape="rect" id="node3" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="428,5,543,32"/><area shape="rect" id="node4" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="425,56,546,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a26de129ca477fc9762d6750b5020914f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_encrypt_page </td>
          <td>(</td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00644">644</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a26de129ca477fc9762d6750b5020914f_cgraph.png" border="0" usemap="#crypto_8c_a26de129ca477fc9762d6750b5020914f_cgraph" alt=""/></div>
<map name="crypto_8c_a26de129ca477fc9762d6750b5020914f_cgraph" id="crypto_8c_a26de129ca477fc9762d6750b5020914f_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="425,5,596,32"/><area shape="rect" id="node3" href="crypto_8c.html#a667352484e3769a93d4d6756207a6294" title="ecryptfs_encrypt_extent" alt="" coords="208,107,371,133"/><area shape="rect" id="node7" href="crypto_8c.html#a740d9efeadec638412712e946d489058" title="ecryptfs_lower_offset\l_for_extent" alt="" coords="216,162,363,203"/><area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#abcca60d451f0a0e8ae33d8738d662fd7" title="ecryptfs_write_lower" alt="" coords="218,56,361,83"/><area shape="rect" id="node4" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="829,84,965,111"/><area shape="rect" id="node5" href="crypto_8c.html#a4edeaa3bc6ab6aaf996f7a8c002c74a1" title="ecryptfs_encrypt_page\l_offset" alt="" coords="433,107,588,149"/><area shape="rect" id="node6" href="crypto_8c.html#a2557a0d17ec106c3b524579a1a68c17b" title="encrypt_scatterlist" alt="" coords="651,111,781,137"/><area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#ab2813066482c96f346fbf23e1eba0d8f" title="ecryptfs_lower_header_size" alt="" coords="419,173,603,200"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a26de129ca477fc9762d6750b5020914f_icgraph.png" border="0" usemap="#crypto_8c_a26de129ca477fc9762d6750b5020914f_icgraph" alt=""/></div>
<map name="crypto_8c_a26de129ca477fc9762d6750b5020914f_icgraph" id="crypto_8c_a26de129ca477fc9762d6750b5020914f_icgraph">
<area shape="rect" id="node2" href="mmap_8c.html#a1c709c67cbb144bffe29cff5a7ac0f8c" title="ecryptfs_writepage" alt="" coords="209,5,341,32"/><area shape="rect" id="node3" href="mmap_8c.html#aba2c17cca4323636c254626963421f3f" title="ecryptfs_write_end" alt="" coords="209,56,341,83"/><area shape="rect" id="node4" href="read__write_8c.html#a1f6fb7e71433ccea976b2cba69741f2a" title="ecryptfs_write" alt="" coords="223,107,327,133"/><area shape="rect" id="node5" href="inode_8c.html#a01b49555f54fc75f2ce9382cee60155e" title="grow_file" alt="" coords="407,81,481,108"/><area shape="rect" id="node8" href="inode_8c.html#a6d535560db4f881686903ff564b74faf" title="truncate_upper" alt="" coords="390,132,498,159"/><area shape="rect" id="node6" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="547,81,693,108"/><area shape="rect" id="node7" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="757,81,869,108"/><area shape="rect" id="node9" href="inode_8c.html#ae6d4593f3f6d169ca3ecc1a07550cec1" title="ecryptfs_truncate" alt="" coords="559,132,681,159"/><area shape="rect" id="node11" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="563,183,677,209"/><area shape="rect" id="node10" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="742,132,885,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4edeaa3bc6ab6aaf996f7a8c002c74a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_encrypt_page_offset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>dst_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dst_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct page *&#160;</td>
          <td class="paramname"><em>src_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>src_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_encrypt_page_offset : The cryptographic context : The page to encrypt into : The offset in the page to encrypt into : The page to encrypt from : The offset in the page to encrypt from : The number of bytes to encrypt : The initialization vector to use for the encryption</p>
<p>Returns the number of bytes encrypted </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00952">952</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a4edeaa3bc6ab6aaf996f7a8c002c74a1_cgraph.png" border="0" usemap="#crypto_8c_a4edeaa3bc6ab6aaf996f7a8c002c74a1_cgraph" alt=""/></div>
<map name="crypto_8c_a4edeaa3bc6ab6aaf996f7a8c002c74a1_cgraph" id="crypto_8c_a4edeaa3bc6ab6aaf996f7a8c002c74a1_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a2557a0d17ec106c3b524579a1a68c17b" title="encrypt_scatterlist" alt="" coords="209,12,338,39"/><area shape="rect" id="node3" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="387,12,523,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a4edeaa3bc6ab6aaf996f7a8c002c74a1_icgraph.png" border="0" usemap="#crypto_8c_a4edeaa3bc6ab6aaf996f7a8c002c74a1_icgraph" alt=""/></div>
<map name="crypto_8c_a4edeaa3bc6ab6aaf996f7a8c002c74a1_icgraph" id="crypto_8c_a4edeaa3bc6ab6aaf996f7a8c002c74a1_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a667352484e3769a93d4d6756207a6294" title="ecryptfs_encrypt_extent" alt="" coords="208,56,371,83"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a26de129ca477fc9762d6750b5020914f" title="ecryptfs_encrypt_page" alt="" coords="419,56,573,83"/><area shape="rect" id="node4" href="mmap_8c.html#a1c709c67cbb144bffe29cff5a7ac0f8c" title="ecryptfs_writepage" alt="" coords="622,5,754,32"/><area shape="rect" id="node5" href="mmap_8c.html#aba2c17cca4323636c254626963421f3f" title="ecryptfs_write_end" alt="" coords="622,56,754,83"/><area shape="rect" id="node6" href="read__write_8c.html#a1f6fb7e71433ccea976b2cba69741f2a" title="ecryptfs_write" alt="" coords="636,107,740,133"/><area shape="rect" id="node7" href="inode_8c.html#a01b49555f54fc75f2ce9382cee60155e" title="grow_file" alt="" coords="820,81,895,108"/><area shape="rect" id="node10" href="inode_8c.html#a6d535560db4f881686903ff564b74faf" title="truncate_upper" alt="" coords="803,132,911,159"/><area shape="rect" id="node8" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="960,81,1107,108"/><area shape="rect" id="node9" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1171,81,1283,108"/><area shape="rect" id="node11" href="inode_8c.html#ae6d4593f3f6d169ca3ecc1a07550cec1" title="ecryptfs_truncate" alt="" coords="972,132,1095,159"/><area shape="rect" id="node13" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="977,183,1090,209"/><area shape="rect" id="node12" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="1155,132,1298,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a83ba6402513da64241081017b40210f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_encrypt_pages </td>
          <td>(</td>
          <td class="paramtype">struct page **&#160;</td>
          <td class="paramname"><em>pgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nr_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00467">467</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a83ba6402513da64241081017b40210f9_cgraph.png" border="0" usemap="#crypto_8c_a83ba6402513da64241081017b40210f9_cgraph" alt=""/></div>
<map name="crypto_8c_a83ba6402513da64241081017b40210f9_cgraph" id="crypto_8c_a83ba6402513da64241081017b40210f9_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="600,28,771,55"/><area shape="rect" id="node3" href="crypto_8c.html#a2557a0d17ec106c3b524579a1a68c17b" title="encrypt_scatterlist" alt="" coords="223,28,353,55"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a0b63d7743285b6e930dd7a651ba92ada" title="ecryptfs_write_lower\l_page_segment" alt="" coords="217,79,359,121"/><area shape="rect" id="node4" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="412,28,548,55"/><area shape="rect" id="node6" href="read__write_8c.html#abcca60d451f0a0e8ae33d8738d662fd7" title="ecryptfs_write_lower" alt="" coords="409,83,551,109"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a83ba6402513da64241081017b40210f9_icgraph.png" border="0" usemap="#crypto_8c_a83ba6402513da64241081017b40210f9_icgraph" alt=""/></div>
<map name="crypto_8c_a83ba6402513da64241081017b40210f9_icgraph" id="crypto_8c_a83ba6402513da64241081017b40210f9_icgraph">
<area shape="rect" id="node2" href="mmap_8c.html#a6271dcf41ac10f0950eddf5c10a9d0f6" title="ecryptfs_writepages" alt="" coords="216,5,355,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9ea5ca17a37e818f2bb40976b23adb9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_encrypt_pages2 </td>
          <td>(</td>
          <td class="paramtype">struct page **&#160;</td>
          <td class="paramname"><em>pgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nr_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00551">551</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a9ea5ca17a37e818f2bb40976b23adb9c_cgraph.png" border="0" usemap="#crypto_8c_a9ea5ca17a37e818f2bb40976b23adb9c_cgraph" alt=""/></div>
<map name="crypto_8c_a9ea5ca17a37e818f2bb40976b23adb9c_cgraph" id="crypto_8c_a9ea5ca17a37e818f2bb40976b23adb9c_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="453,107,624,133"/><area shape="rect" id="node3" href="crypto_8c.html#a2557a0d17ec106c3b524579a1a68c17b" title="encrypt_scatterlist" alt="" coords="249,5,378,32"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#ab2813066482c96f346fbf23e1eba0d8f" title="ecryptfs_lower_header_size" alt="" coords="221,107,405,133"/><area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#abcca60d451f0a0e8ae33d8738d662fd7" title="ecryptfs_write_lower" alt="" coords="242,157,385,184"/><area shape="rect" id="node4" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="471,5,607,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a9ea5ca17a37e818f2bb40976b23adb9c_icgraph.png" border="0" usemap="#crypto_8c_a9ea5ca17a37e818f2bb40976b23adb9c_icgraph" alt=""/></div>
<map name="crypto_8c_a9ea5ca17a37e818f2bb40976b23adb9c_icgraph" id="crypto_8c_a9ea5ca17a37e818f2bb40976b23adb9c_icgraph">
<area shape="rect" id="node2" href="read__write_8c.html#a7069e6270fd6afd0bb49e7259cd74810" title="ecryptfs_write2" alt="" coords="222,5,333,32"/><area shape="rect" id="node3" href="file_8c.html#a728728ea4482c58bb7b9cabbc7bfcd3f" title="ecryptfs_file_write" alt="" coords="381,5,509,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a53b9fe052c3394cc747e08e884df0926"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_from_hex </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dst_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_from_hex : Buffer to take the bytes from src hex; must be at least of size (src_size / 2) : Buffer to be converted from a hex string respresentation to raw value : size of dst buffer, or number of hex characters pairs to convert </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00083">83</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a53b9fe052c3394cc747e08e884df0926_icgraph.png" border="0" usemap="#crypto_8c_a53b9fe052c3394cc747e08e884df0926_icgraph" alt=""/></div>
<map name="crypto_8c_a53b9fe052c3394cc747e08e884df0926_icgraph" id="crypto_8c_a53b9fe052c3394cc747e08e884df0926_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="187,34,317,75"/><area shape="rect" id="node7" href="keystore_8c.html#ac6bc314de94c6d266926cc7dc0219c5b" title="write_tag_1_packet" alt="" coords="185,100,319,127"/><area shape="rect" id="node13" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="185,151,319,177"/><area shape="rect" id="node3" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="369,41,543,68"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="611,34,757,75"/><area shape="rect" id="node5" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="849,5,964,32"/><area shape="rect" id="node6" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="846,56,967,83"/><area shape="rect" id="node8" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="379,114,533,155"/><area shape="rect" id="node9" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="593,121,775,148"/><area shape="rect" id="node10" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="824,121,989,148"/><area shape="rect" id="node11" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1037,121,1184,148"/><area shape="rect" id="node12" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1232,121,1344,148"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0bad7026cdc7157c2d78fda1c58b5789"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ecryptfs_generate_new_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01118">1118</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a0bad7026cdc7157c2d78fda1c58b5789_cgraph.png" border="0" usemap="#crypto_8c_a0bad7026cdc7157c2d78fda1c58b5789_cgraph" alt=""/></div>
<map name="crypto_8c_a0bad7026cdc7157c2d78fda1c58b5789_cgraph" id="crypto_8c_a0bad7026cdc7157c2d78fda1c58b5789_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a010c33619300979023e302badcdbd3b5" title="ecryptfs_compute_root_iv" alt="" coords="241,5,413,32"/><area shape="rect" id="node4" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="259,56,395,83"/><area shape="rect" id="node3" href="crypto_8c.html#afe9ebb3f8af0e14969d856f179bccc8d" title="ecryptfs_calculate_md5" alt="" coords="461,5,621,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a0bad7026cdc7157c2d78fda1c58b5789_icgraph.png" border="0" usemap="#crypto_8c_a0bad7026cdc7157c2d78fda1c58b5789_icgraph" alt=""/></div>
<map name="crypto_8c_a0bad7026cdc7157c2d78fda1c58b5789_icgraph" id="crypto_8c_a0bad7026cdc7157c2d78fda1c58b5789_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="241,5,415,32"/><area shape="rect" id="node3" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="464,5,611,32"/><area shape="rect" id="node4" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="659,5,771,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af479d34da23aa4c6382373fdce1f7bbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_get_tfm_and_mutex_for_cipher_name </td>
          <td>(</td>
          <td class="paramtype">struct crypto_blkcipher **&#160;</td>
          <td class="paramname"><em>tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct mutex **&#160;</td>
          <td class="paramname"><em>tfm_mutex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cipher_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_get_tfm_and_mutex_for_cipher_name</p>
<p>: set to cached tfm found, or new tfm created : set to mutex for cached tfm found, or new tfm created : the name of the cipher to search for and/or add</p>
<p>Sets pointers to  &amp;  matching . Searches for cached item first, and creates new if not found. Returns 0 on success, non-zero if adding new cipher failed </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02138">2138</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_af479d34da23aa4c6382373fdce1f7bbf_cgraph.png" border="0" usemap="#crypto_8c_af479d34da23aa4c6382373fdce1f7bbf_cgraph" alt=""/></div>
<map name="crypto_8c_af479d34da23aa4c6382373fdce1f7bbf_cgraph" id="crypto_8c_af479d34da23aa4c6382373fdce1f7bbf_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="245,5,382,32"/><area shape="rect" id="node3" href="crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="222,56,405,83"/><area shape="rect" id="node4" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25" title="ecryptfs_process_key\l_cipher" alt="" coords="454,19,605,61"/><area shape="rect" id="node6" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="496,85,563,112"/><area shape="rect" id="node5" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="653,19,795,61"/><area shape="rect" id="node7" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="683,85,765,112"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_af479d34da23aa4c6382373fdce1f7bbf_icgraph.png" border="0" usemap="#crypto_8c_af479d34da23aa4c6382373fdce1f7bbf_icgraph" alt=""/></div>
<map name="crypto_8c_af479d34da23aa4c6382373fdce1f7bbf_icgraph" id="crypto_8c_af479d34da23aa4c6382373fdce1f7bbf_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="241,107,370,149"/><area shape="rect" id="node7" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="239,174,372,215"/><area shape="rect" id="node14" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="222,241,389,282"/><area shape="rect" id="node20" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="238,307,373,333"/><area shape="rect" id="node3" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="439,112,614,139"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="683,49,829,90"/><area shape="rect" id="node5" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="921,5,1036,32"/><area shape="rect" id="node6" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="918,56,1039,83"/><area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="453,166,600,207"/><area shape="rect" id="node9" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="705,121,807,148"/><area shape="rect" id="node11" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="677,173,835,200"/><area shape="rect" id="node10" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="921,107,1036,133"/><area shape="rect" id="node12" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="918,157,1039,184"/><area shape="rect" id="node13" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="909,208,1049,235"/><area shape="rect" id="node15" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="437,248,616,275"/><area shape="rect" id="node16" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="667,253,845,280"/><area shape="rect" id="node17" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="897,259,1060,285"/><area shape="rect" id="node18" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1131,208,1235,235"/><area shape="rect" id="node19" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1126,259,1239,285"/><area shape="rect" id="node21" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="449,299,604,341"/><area shape="rect" id="node22" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="665,309,847,336"/><area shape="rect" id="node23" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="896,309,1061,336"/><area shape="rect" id="node24" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1109,309,1256,336"/><area shape="rect" id="node25" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1304,309,1416,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac0f2f172cce958308b370bfd82334710"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned long ecryptfs_get_zeroed_pages </td>
          <td>(</td>
          <td class="paramtype">gfp_t&#160;</td>
          <td class="paramname"><em>gfp_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01575">1575</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ac0f2f172cce958308b370bfd82334710_icgraph.png" border="0" usemap="#crypto_8c_ac0f2f172cce958308b370bfd82334710_icgraph" alt=""/></div>
<map name="crypto_8c_ac0f2f172cce958308b370bfd82334710_icgraph" id="crypto_8c_ac0f2f172cce958308b370bfd82334710_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="195,12,360,39"/><area shape="rect" id="node3" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="408,12,555,39"/><area shape="rect" id="node4" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="603,12,715,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa6806b87a57ada237cc52b391b0b70dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_init_crypt_ctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_init_crypt_ctx : Uninitialized crypt stats structure</p>
<p>Initialize the crypto context.</p>
<p>TODO: Performance: Keep a cache of initialized cipher contexts; only init if needed </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01007">1007</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_aa6806b87a57ada237cc52b391b0b70dc_cgraph.png" border="0" usemap="#crypto_8c_aa6806b87a57ada237cc52b391b0b70dc_cgraph" alt=""/></div>
<map name="crypto_8c_aa6806b87a57ada237cc52b391b0b70dc_cgraph" id="crypto_8c_aa6806b87a57ada237cc52b391b0b70dc_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="208,5,349,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_aa6806b87a57ada237cc52b391b0b70dc_icgraph.png" border="0" usemap="#crypto_8c_aa6806b87a57ada237cc52b391b0b70dc_icgraph" alt=""/></div>
<map name="crypto_8c_aa6806b87a57ada237cc52b391b0b70dc_icgraph" id="crypto_8c_aa6806b87a57ada237cc52b391b0b70dc_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="209,5,383,32"/><area shape="rect" id="node5" href="keystore_8c.html#a32c87c3d9f5f82f8e86006f94b9130d3" title="parse_tag_3_packet" alt="" coords="227,56,365,83"/><area shape="rect" id="node6" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="432,81,611,108"/><area shape="rect" id="node3" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="448,5,595,32"/><area shape="rect" id="node4" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="692,5,804,32"/><area shape="rect" id="node7" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="659,81,837,108"/><area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="885,81,1048,108"/><area shape="rect" id="node9" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1101,56,1205,83"/><area shape="rect" id="node10" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1097,107,1210,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab6d11d966fbe85483b98bf5cb2fec6a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_init_crypt_stat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_init_crypt_stat : Pointer to the crypt_stat struct to initialize.</p>
<p>Initialize the crypt_stat structure. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00234">234</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ab6d11d966fbe85483b98bf5cb2fec6a6_cgraph.png" border="0" usemap="#crypto_8c_ab6d11d966fbe85483b98bf5cb2fec6a6_cgraph" alt=""/></div>
<map name="crypto_8c_ab6d11d966fbe85483b98bf5cb2fec6a6_cgraph" id="crypto_8c_ab6d11d966fbe85483b98bf5cb2fec6a6_cgraph">
<area shape="rect" id="node2" href="list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title="INIT_LIST_HEAD" alt="" coords="213,5,341,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ab6d11d966fbe85483b98bf5cb2fec6a6_icgraph.png" border="0" usemap="#crypto_8c_ab6d11d966fbe85483b98bf5cb2fec6a6_icgraph" alt=""/></div>
<map name="crypto_8c_ab6d11d966fbe85483b98bf5cb2fec6a6_icgraph" id="crypto_8c_ab6d11d966fbe85483b98bf5cb2fec6a6_icgraph">
<area shape="rect" id="node2" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="227,5,341,32"/><area shape="rect" id="node3" href="super_8c.html#a1442d3999b0917087043d8a8801682d9" title="ecryptfs_alloc_inode" alt="" coords="213,56,355,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a00d0a5dfb857ae4cb4873001e6393d79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __init ecryptfs_init_crypto </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02031">2031</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a00d0a5dfb857ae4cb4873001e6393d79_cgraph.png" border="0" usemap="#crypto_8c_a00d0a5dfb857ae4cb4873001e6393d79_cgraph" alt=""/></div>
<map name="crypto_8c_a00d0a5dfb857ae4cb4873001e6393d79_cgraph" id="crypto_8c_a00d0a5dfb857ae4cb4873001e6393d79_cgraph">
<area shape="rect" id="node2" href="list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title="INIT_LIST_HEAD" alt="" coords="189,5,317,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a00d0a5dfb857ae4cb4873001e6393d79_icgraph.png" border="0" usemap="#crypto_8c_a00d0a5dfb857ae4cb4873001e6393d79_icgraph" alt=""/></div>
<map name="crypto_8c_a00d0a5dfb857ae4cb4873001e6393d79_icgraph" id="crypto_8c_a00d0a5dfb857ae4cb4873001e6393d79_icgraph">
<area shape="rect" id="node2" href="services_2gaes_2ecryptfs_2main_8c.html#abe6d03208b49def9b19a36c8a79373b9" title="ecryptfs_init" alt="" coords="189,5,283,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a740d9efeadec638412712e946d489058"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ecryptfs_lower_offset_for_extent </td>
          <td>(</td>
          <td class="paramtype">loff_t *&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t&#160;</td>
          <td class="paramname"><em>extent_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_lower_offset_for_extent</p>
<p>Convert an eCryptfs page index into a lower byte offset </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00392">392</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a740d9efeadec638412712e946d489058_cgraph.png" border="0" usemap="#crypto_8c_a740d9efeadec638412712e946d489058_cgraph" alt=""/></div>
<map name="crypto_8c_a740d9efeadec638412712e946d489058_cgraph" id="crypto_8c_a740d9efeadec638412712e946d489058_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ab2813066482c96f346fbf23e1eba0d8f" title="ecryptfs_lower_header_size" alt="" coords="200,12,384,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a740d9efeadec638412712e946d489058_icgraph.png" border="0" usemap="#crypto_8c_a740d9efeadec638412712e946d489058_icgraph" alt=""/></div>
<map name="crypto_8c_a740d9efeadec638412712e946d489058_icgraph" id="crypto_8c_a740d9efeadec638412712e946d489058_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a26de129ca477fc9762d6750b5020914f" title="ecryptfs_encrypt_page" alt="" coords="200,101,355,128"/><area shape="rect" id="node13" href="ecryptfs__kernel_8h.html#a8f0e0486293ab97cca8219ee1fee7f4b" title="ecryptfs_decrypt_page" alt="" coords="200,164,355,191"/><area shape="rect" id="node3" href="mmap_8c.html#a1c709c67cbb144bffe29cff5a7ac0f8c" title="ecryptfs_writepage" alt="" coords="403,5,535,32"/><area shape="rect" id="node4" href="mmap_8c.html#aba2c17cca4323636c254626963421f3f" title="ecryptfs_write_end" alt="" coords="403,56,535,83"/><area shape="rect" id="node5" href="read__write_8c.html#a1f6fb7e71433ccea976b2cba69741f2a" title="ecryptfs_write" alt="" coords="417,107,521,133"/><area shape="rect" id="node6" href="inode_8c.html#a01b49555f54fc75f2ce9382cee60155e" title="grow_file" alt="" coords="615,37,689,64"/><area shape="rect" id="node9" href="inode_8c.html#a6d535560db4f881686903ff564b74faf" title="truncate_upper" alt="" coords="598,107,706,133"/><area shape="rect" id="node7" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="768,12,915,39"/><area shape="rect" id="node8" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="979,12,1091,39"/><area shape="rect" id="node10" href="inode_8c.html#ae6d4593f3f6d169ca3ecc1a07550cec1" title="ecryptfs_truncate" alt="" coords="780,63,903,89"/><area shape="rect" id="node12" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="785,113,898,140"/><area shape="rect" id="node11" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="963,113,1106,140"/><area shape="rect" id="node14" href="mmap_8c.html#a8f8e487f41eae0bd59f0f73483c8b0bd" title="ecryptfs_readpage" alt="" coords="405,215,534,241"/><area shape="rect" id="node15" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="584,215,720,241"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9a076756b4a12fe2b1913c58313bed8f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_new_file_context </td>
          <td>(</td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_new_file_context : The eCryptfs dentry</p>
<p>If the crypto context for the file has not yet been established, this is where we do that. Establishing a new crypto context involves the following decisions:</p>
<ul>
<li>What cipher to use?</li>
<li>What set of authentication tokens to use? Here we just worry about getting enough information into the authentication tokens so that we know that they are available. We associate the available authentication tokens with the new file via the set of signatures in the crypt_stat struct. Later, when the headers are actually written out, we may again defer to userspace to perform the encryption of the session key; for the foreseeable future, this will be the case with public key packets.</li>
</ul>
<p>Returns zero on success; non-zero otherwise </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01225">1225</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a9a076756b4a12fe2b1913c58313bed8f_cgraph.png" border="0" usemap="#crypto_8c_a9a076756b4a12fe2b1913c58313bed8f_cgraph" alt=""/></div>
<map name="crypto_8c_a9a076756b4a12fe2b1913c58313bed8f_cgraph" id="crypto_8c_a9a076756b4a12fe2b1913c58313bed8f_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="237,5,408,32"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#ab0987a55f9bd100b72e69f9dc54d1e39" title="ecryptfs_superblock\l_to_private" alt="" coords="253,57,392,98"/><area shape="rect" id="node4" href="crypto_8c.html#a43a35c67336e7e2dc9545638ffedda7e" title="ecryptfs_set_default\l_crypt_stat_vals" alt="" coords="253,174,393,215"/><area shape="rect" id="node5" href="crypto_8c.html#a4c1f20c33cc83c9fae00176557a101d2" title="ecryptfs_copy_mount\l_wide_flags_to_inode_flags" alt="" coords="465,115,647,157"/><area shape="rect" id="node8" href="crypto_8c.html#a81000f6bbd25c79214005d46daa3d6ca" title="ecryptfs_copy_mount\l_wide_sigs_to_inode_sigs" alt="" coords="235,239,410,281"/><area shape="rect" id="node12" href="crypto_8c.html#a0bad7026cdc7157c2d78fda1c58b5789" title="ecryptfs_generate_new_key" alt="" coords="230,305,415,332"/><area shape="rect" id="node16" href="crypto_8c.html#aa6806b87a57ada237cc52b391b0b70dc" title="ecryptfs_init_crypt_ctx" alt="" coords="245,381,400,408"/><area shape="rect" id="node6" href="crypto_8c.html#ae0c1e94df9a9186bb509360c1476c353" title="ecryptfs_set_default\l_sizes" alt="" coords="486,181,626,222"/><area shape="rect" id="node7" href="crypto_8c.html#a021875e559b602a9bd59ef32416337dc" title="set_extent_mask_and\l_shift" alt="" coords="701,181,851,222"/><area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#acac9a69d1ef9650a4dc86067d4632c41" title="ecryptfs_add_keysig" alt="" coords="485,247,627,273"/><area shape="rect" id="node10" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="743,247,809,273"/><area shape="rect" id="node11" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="905,247,986,273"/><area shape="rect" id="node13" href="crypto_8c.html#a010c33619300979023e302badcdbd3b5" title="ecryptfs_compute_root_iv" alt="" coords="470,297,642,324"/><area shape="rect" id="node15" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="488,348,624,375"/><area shape="rect" id="node14" href="crypto_8c.html#afe9ebb3f8af0e14969d856f179bccc8d" title="ecryptfs_calculate_md5" alt="" coords="696,297,856,324"/><area shape="rect" id="node17" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="485,399,627,441"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a9a076756b4a12fe2b1913c58313bed8f_icgraph.png" border="0" usemap="#crypto_8c_a9a076756b4a12fe2b1913c58313bed8f_icgraph" alt=""/></div>
<map name="crypto_8c_a9a076756b4a12fe2b1913c58313bed8f_icgraph" id="crypto_8c_a9a076756b4a12fe2b1913c58313bed8f_icgraph">
<area shape="rect" id="node2" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="229,5,376,32"/><area shape="rect" id="node3" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="424,5,536,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a70ef2b489032eed23b63b36ef67b99fc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_process_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>page_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_process_flags : The cryptographic context : Source data to be parsed : Updated with the number of bytes read</p>
<p>Returns zero on success; non-zero if the flag set is invalid </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01307">1307</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a70ef2b489032eed23b63b36ef67b99fc_icgraph.png" border="0" usemap="#crypto_8c_a70ef2b489032eed23b63b36ef67b99fc_icgraph" alt=""/></div>
<map name="crypto_8c_a70ef2b489032eed23b63b36ef67b99fc_icgraph" id="crypto_8c_a70ef2b489032eed23b63b36ef67b99fc_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="211,31,389,57"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="437,31,600,57"/><area shape="rect" id="node4" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="653,5,757,32"/><area shape="rect" id="node5" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="649,56,762,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a89e7a8582efdfa475ae354125c5abb25"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_process_key_cipher </td>
          <td>(</td>
          <td class="paramtype">struct crypto_blkcipher **&#160;</td>
          <td class="paramname"><em>key_tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cipher_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>key_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_process_key_cipher - Perform key cipher initialization. : Crypto context for key material, set by this function : Name of the cipher : Size of the key in bytes</p>
<p>Returns zero on success. Any crypto_tfm structs allocated here should be released by other functions, such as on a superblock put event, regardless of whether this function succeeds for fails. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01982">1982</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a89e7a8582efdfa475ae354125c5abb25_cgraph.png" border="0" usemap="#crypto_8c_a89e7a8582efdfa475ae354125c5abb25_cgraph" alt=""/></div>
<map name="crypto_8c_a89e7a8582efdfa475ae354125c5abb25_cgraph" id="crypto_8c_a89e7a8582efdfa475ae354125c5abb25_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="205,5,347,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a89e7a8582efdfa475ae354125c5abb25_icgraph.png" border="0" usemap="#crypto_8c_a89e7a8582efdfa475ae354125c5abb25_icgraph" alt=""/></div>
<map name="crypto_8c_a89e7a8582efdfa475ae354125c5abb25_icgraph" id="crypto_8c_a89e7a8582efdfa475ae354125c5abb25_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="206,135,389,161"/><area shape="rect" id="node3" href="services_2gaes_2ecryptfs_2main_8c.html#ad2a806cb5b6290a55a1d14c514ac0590" title="ecryptfs_parse_options" alt="" coords="443,89,600,116"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="437,173,605,214"/><area shape="rect" id="node4" href="services_2gaes_2ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="681,56,793,83"/><area shape="rect" id="node6" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="673,107,802,149"/><area shape="rect" id="node11" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="671,173,804,214"/><area shape="rect" id="node18" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="654,239,821,281"/><area shape="rect" id="node24" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="670,307,805,333"/><area shape="rect" id="node7" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="871,112,1046,139"/><area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="1115,49,1261,90"/><area shape="rect" id="node9" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="1353,5,1468,32"/><area shape="rect" id="node10" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1350,56,1471,83"/><area shape="rect" id="node12" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="885,166,1032,207"/><area shape="rect" id="node13" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="1137,121,1239,148"/><area shape="rect" id="node15" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="1109,173,1267,200"/><area shape="rect" id="node14" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="1353,107,1468,133"/><area shape="rect" id="node16" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="1350,157,1471,184"/><area shape="rect" id="node17" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="1341,208,1481,235"/><area shape="rect" id="node19" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="869,247,1048,273"/><area shape="rect" id="node20" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="1099,253,1277,280"/><area shape="rect" id="node21" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1329,259,1492,285"/><area shape="rect" id="node22" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1563,208,1667,235"/><area shape="rect" id="node23" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1558,259,1671,285"/><area shape="rect" id="node25" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="881,299,1036,341"/><area shape="rect" id="node26" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="1097,309,1279,336"/><area shape="rect" id="node27" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="1328,309,1493,336"/><area shape="rect" id="node28" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1541,309,1688,336"/><area shape="rect" id="node29" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1736,309,1848,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1fe598009db325ac45c099f00a506eaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_read_and_validate_header_region </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct inode *&#160;</td>
          <td class="paramname"><em>ecryptfs_inode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01442">1442</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a1fe598009db325ac45c099f00a506eaf_cgraph.png" border="0" usemap="#crypto_8c_a1fe598009db325ac45c099f00a506eaf_cgraph" alt=""/></div>
<map name="crypto_8c_a1fe598009db325ac45c099f00a506eaf_cgraph" id="crypto_8c_a1fe598009db325ac45c099f00a506eaf_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="456,5,627,32"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a7a8f9447eb75e1878c99de4166fdd6fb" title="ecryptfs_read_lower" alt="" coords="252,31,391,57"/><area shape="rect" id="node4" href="crypto_8c.html#a6351e3152155696288917740cc9c849d" title="contains_ecryptfs_marker" alt="" coords="235,81,407,108"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a1fe598009db325ac45c099f00a506eaf_icgraph.png" border="0" usemap="#crypto_8c_a1fe598009db325ac45c099f00a506eaf_icgraph" alt=""/></div>
<map name="crypto_8c_a1fe598009db325ac45c099f00a506eaf_icgraph" id="crypto_8c_a1fe598009db325ac45c099f00a506eaf_icgraph">
<area shape="rect" id="node2" href="inode_8c.html#ad1f58d0fd3b46f3063934fe8f6513f45" title="ecryptfs_lookup_and\l_interpose_lower" alt="" coords="235,5,378,46"/><area shape="rect" id="node3" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="427,12,541,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ade462ad60d1c69a5246f7623f09374a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_read_and_validate_xattr_region </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>page_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01786">1786</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ade462ad60d1c69a5246f7623f09374a1_cgraph.png" border="0" usemap="#crypto_8c_ade462ad60d1c69a5246f7623f09374a1_cgraph" alt=""/></div>
<map name="crypto_8c_ade462ad60d1c69a5246f7623f09374a1_cgraph" id="crypto_8c_ade462ad60d1c69a5246f7623f09374a1_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a0328356e623d00183afc5c85cc63e932" title="ecryptfs_read_xattr\l_region" alt="" coords="254,23,389,65"/><area shape="rect" id="node5" href="crypto_8c.html#a6351e3152155696288917740cc9c849d" title="contains_ecryptfs_marker" alt="" coords="235,89,407,116"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="456,5,627,32"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a0db90fed68f8445f1edba3136bc2b11a" title="ecryptfs_getxattr_lower" alt="" coords="462,56,621,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ade462ad60d1c69a5246f7623f09374a1_icgraph.png" border="0" usemap="#crypto_8c_ade462ad60d1c69a5246f7623f09374a1_icgraph" alt=""/></div>
<map name="crypto_8c_ade462ad60d1c69a5246f7623f09374a1_icgraph" id="crypto_8c_ade462ad60d1c69a5246f7623f09374a1_icgraph">
<area shape="rect" id="node2" href="inode_8c.html#ad1f58d0fd3b46f3063934fe8f6513f45" title="ecryptfs_lookup_and\l_interpose_lower" alt="" coords="235,5,378,46"/><area shape="rect" id="node3" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="427,12,541,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1971b0423a0e1cbe741f78712d319b20"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_read_headers_virt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>page_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>validate_header_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_read_headers_virt : The virtual address into which to read the headers : The cryptographic context : The eCryptfs dentry : Whether to validate the header size while reading</p>
<p>Read/parse the header data. The header format is detailed in the comment block for the <a class="el" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10">ecryptfs_write_headers_virt()</a> function.</p>
<p>Returns zero on success </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01704">1704</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a1971b0423a0e1cbe741f78712d319b20_cgraph.png" border="0" usemap="#crypto_8c_a1971b0423a0e1cbe741f78712d319b20_cgraph" alt=""/></div>
<map name="crypto_8c_a1971b0423a0e1cbe741f78712d319b20_cgraph" id="crypto_8c_a1971b0423a0e1cbe741f78712d319b20_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#ae0c1e94df9a9186bb509360c1476c353" title="ecryptfs_set_default\l_sizes" alt="" coords="251,21,391,62"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#ab0987a55f9bd100b72e69f9dc54d1e39" title="ecryptfs_superblock\l_to_private" alt="" coords="252,117,391,158"/><area shape="rect" id="node5" href="crypto_8c.html#a6351e3152155696288917740cc9c849d" title="contains_ecryptfs_marker" alt="" coords="235,183,407,209"/><area shape="rect" id="node6" href="crypto_8c.html#a70ef2b489032eed23b63b36ef67b99fc" title="ecryptfs_process_flags" alt="" coords="243,233,400,260"/><area shape="rect" id="node7" href="crypto_8c.html#abc63e296860a38dd41bb90bd8bbcde51" title="parse_header_metadata" alt="" coords="241,284,402,311"/><area shape="rect" id="node8" href="crypto_8c.html#a7547fa51803046747c7184904e499062" title="set_default_header_data" alt="" coords="239,335,403,361"/><area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="232,447,411,473"/><area shape="rect" id="node3" href="crypto_8c.html#a021875e559b602a9bd59ef32416337dc" title="set_extent_mask_and\l_shift" alt="" coords="470,5,621,46"/><area shape="rect" id="node10" href="list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title="INIT_LIST_HEAD" alt="" coords="481,121,609,148"/><area shape="rect" id="node11" href="keystore_8c.html#a32c87c3d9f5f82f8e86006f94b9130d3" title="parse_tag_3_packet" alt="" coords="476,361,615,388"/><area shape="rect" id="node14" href="crypto_8c.html#aa6806b87a57ada237cc52b391b0b70dc" title="ecryptfs_init_crypt_ctx" alt="" coords="695,368,849,395"/><area shape="rect" id="node18" href="keystore_8c.html#a30981d0242b86acbe5a11d007022a828" title="parse_tag_11_packet" alt="" coords="472,172,619,199"/><area shape="rect" id="node19" href="crypto_8c.html#a600a433968f0fca6c59d0503e4a13adc" title="ecryptfs_to_hex" alt="" coords="715,216,829,243"/><area shape="rect" id="node20" href="keystore_8c.html#ac0f59c651d74024aedd73031beadeca5" title="parse_tag_1_packet" alt="" coords="476,223,615,249"/><area shape="rect" id="node21" href="list_8h.html#a6601e54d8f27ab290ee6819f7e2127b7" title="list_empty" alt="" coords="1368,877,1451,904"/><area shape="rect" id="node22" href="debug_8c.html#a77caaec801939ef76ff0cb3c11e529b4" title="ecryptfs_dump_auth_tok" alt="" coords="463,463,628,489"/><area shape="rect" id="node24" href="keystore_8c.html#a5192f320ce5afdac99056c1e06ad771f" title="ecryptfs_get_auth_tok_sig" alt="" coords="685,856,859,883"/><area shape="rect" id="node25" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="481,958,610,999"/><area shape="rect" id="node31" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="469,637,622,678"/><area shape="rect" id="node41" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="462,518,629,559"/><area shape="rect" id="node46" href="list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title="list_del" alt="" coords="741,1089,803,1116"/><area shape="rect" id="node48" href="crypto_8c.html#a010c33619300979023e302badcdbd3b5" title="ecryptfs_compute_root_iv" alt="" coords="459,71,631,97"/><area shape="rect" id="node50" href="keystore_8c.html#a90a8b7a243cf75059dfee4f58aed97a2" title="wipe_auth_tok_list" alt="" coords="480,1085,611,1112"/><area shape="rect" id="node12" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="939,205,1093,246"/><area shape="rect" id="node13" href="crypto_8c.html#a9ec4f1a07858b147d07a4691fccc9741" title="ecryptfs_cipher_code\l_to_string" alt="" coords="699,419,845,461"/><area shape="rect" id="node16" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="1211,317,1277,344"/><area shape="rect" id="node15" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="945,369,1087,410"/><area shape="rect" id="node17" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="1369,317,1450,344"/><area shape="rect" id="node23" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="704,485,840,512"/><area shape="rect" id="node26" href="keystore_8c.html#a2a70f7a5ff64535e0cb220b179e1982f" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="703,958,841,999"/><area shape="rect" id="node27" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="697,1023,847,1065"/><area shape="rect" id="node28" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="932,1069,1100,1096"/><area shape="rect" id="node29" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="913,968,1119,995"/><area shape="rect" id="node30" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="937,1019,1095,1045"/><area shape="rect" id="node32" href="keystore_8c.html#a139436651ca07d4aa32396fbae14d1f9" title="write_tag_64_packet" alt="" coords="701,755,843,781"/><area shape="rect" id="node34" href="ecryptfs__kernel_8h.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="690,805,854,832"/><area shape="rect" id="node38" href="ecryptfs__kernel_8h.html#a69946a18f3a52d43a34a76f700dea047" title="ecryptfs_wait_for_response" alt="" coords="681,704,863,731"/><area shape="rect" id="node40" href="keystore_8c.html#a01fe01b7c058e56d355ac11eca7a3749" title="parse_tag_65_packet" alt="" coords="699,587,845,613"/><area shape="rect" id="node33" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="941,754,1091,795"/><area shape="rect" id="node35" href="messaging_8c.html#a10730ea01271b89e1dbd74f64cff553f" title="ecryptfs_send_message\l_locked" alt="" coords="934,819,1098,861"/><area shape="rect" id="node36" href="messaging_8c.html#a785e6d04b5b757664a8c0d7e48bbf5ee" title="ecryptfs_find_daemon\l_by_euid" alt="" coords="1169,775,1319,817"/><area shape="rect" id="node37" href="messaging_8c.html#a3cf131d292b1e79c317132d722ad3bb3" title="ecryptfs_acquire_free\l_msg_ctx" alt="" coords="1171,841,1317,882"/><area shape="rect" id="node39" href="messaging_8c.html#afa5f0c6e4ccfb9753a323ff2c5ae993c" title="ecryptfs_msg_ctx_alloc\l_to_free" alt="" coords="936,689,1096,730"/><area shape="rect" id="node42" href="crypto_8c.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="688,638,856,679"/><area shape="rect" id="node45" href="crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="711,536,833,563"/><area shape="rect" id="node43" href="crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="947,637,1085,664"/><area shape="rect" id="node44" href="crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="925,511,1107,537"/><area shape="rect" id="node47" href="list_8h.html#a24b474717d65a296695e8b79b4adefda" title="__list_del" alt="" coords="977,1120,1055,1147"/><area shape="rect" id="node49" href="crypto_8c.html#afe9ebb3f8af0e14969d856f179bccc8d" title="ecryptfs_calculate_md5" alt="" coords="692,13,852,40"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a1971b0423a0e1cbe741f78712d319b20_icgraph.png" border="0" usemap="#crypto_8c_a1971b0423a0e1cbe741f78712d319b20_icgraph" alt=""/></div>
<map name="crypto_8c_a1971b0423a0e1cbe741f78712d319b20_icgraph" id="crypto_8c_a1971b0423a0e1cbe741f78712d319b20_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="232,31,395,57"/><area shape="rect" id="node3" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="448,5,552,32"/><area shape="rect" id="node4" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="443,56,557,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0f476d4db45796bb804042157fbd93fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_read_metadata </td>
          <td>(</td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_read_metadata</p>
<p>Common entry point for reading file metadata. From here, we could retrieve the header information from the header region of the file, the xattr region of the file, or some other repostory that is stored separately from the file itself. The current implementation supports retrieving the metadata information from the file contents and from the xattr region.</p>
<p>Returns zero if valid headers found and parsed; non-zero otherwise </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01815">1815</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a0f476d4db45796bb804042157fbd93fa_cgraph.png" border="0" usemap="#crypto_8c_a0f476d4db45796bb804042157fbd93fa_cgraph" alt=""/></div>
<map name="crypto_8c_a0f476d4db45796bb804042157fbd93fa_cgraph" id="crypto_8c_a0f476d4db45796bb804042157fbd93fa_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="452,200,623,227"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#ab0987a55f9bd100b72e69f9dc54d1e39" title="ecryptfs_superblock\l_to_private" alt="" coords="468,306,607,347"/><area shape="rect" id="node4" href="crypto_8c.html#a4c1f20c33cc83c9fae00176557a101d2" title="ecryptfs_copy_mount\l_wide_flags_to_inode_flags" alt="" coords="217,474,399,515"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a7a8f9447eb75e1878c99de4166fdd6fb" title="ecryptfs_read_lower" alt="" coords="239,200,377,227"/><area shape="rect" id="node6" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="219,423,397,449"/><area shape="rect" id="node49" href="crypto_8c.html#a0328356e623d00183afc5c85cc63e932" title="ecryptfs_read_xattr\l_region" alt="" coords="241,251,375,293"/><area shape="rect" id="node7" href="crypto_8c.html#ae0c1e94df9a9186bb509360c1476c353" title="ecryptfs_set_default\l_sizes" alt="" coords="467,525,607,566"/><area shape="rect" id="node9" href="crypto_8c.html#a6351e3152155696288917740cc9c849d" title="contains_ecryptfs_marker" alt="" coords="451,591,623,617"/><area shape="rect" id="node10" href="crypto_8c.html#a70ef2b489032eed23b63b36ef67b99fc" title="ecryptfs_process_flags" alt="" coords="459,641,616,668"/><area shape="rect" id="node11" href="crypto_8c.html#abc63e296860a38dd41bb90bd8bbcde51" title="parse_header_metadata" alt="" coords="457,372,618,399"/><area shape="rect" id="node12" href="crypto_8c.html#a7547fa51803046747c7184904e499062" title="set_default_header_data" alt="" coords="455,423,619,449"/><area shape="rect" id="node13" href="ecryptfs__kernel_8h.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="448,473,627,500"/><area shape="rect" id="node8" href="crypto_8c.html#a021875e559b602a9bd59ef32416337dc" title="set_extent_mask_and\l_shift" alt="" coords="686,957,837,998"/><area shape="rect" id="node14" href="list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title="INIT_LIST_HEAD" alt="" coords="697,107,825,133"/><area shape="rect" id="node15" href="keystore_8c.html#a32c87c3d9f5f82f8e86006f94b9130d3" title="parse_tag_3_packet" alt="" coords="692,309,831,336"/><area shape="rect" id="node18" href="crypto_8c.html#aa6806b87a57ada237cc52b391b0b70dc" title="ecryptfs_init_crypt_ctx" alt="" coords="911,309,1065,336"/><area shape="rect" id="node22" href="keystore_8c.html#a30981d0242b86acbe5a11d007022a828" title="parse_tag_11_packet" alt="" coords="688,157,835,184"/><area shape="rect" id="node23" href="crypto_8c.html#a600a433968f0fca6c59d0503e4a13adc" title="ecryptfs_to_hex" alt="" coords="931,208,1045,235"/><area shape="rect" id="node24" href="keystore_8c.html#ac0f59c651d74024aedd73031beadeca5" title="parse_tag_1_packet" alt="" coords="692,208,831,235"/><area shape="rect" id="node25" href="list_8h.html#a6601e54d8f27ab290ee6819f7e2127b7" title="list_empty" alt="" coords="720,679,803,705"/><area shape="rect" id="node26" href="debug_8c.html#a77caaec801939ef76ff0cb3c11e529b4" title="ecryptfs_dump_auth_tok" alt="" coords="679,444,844,471"/><area shape="rect" id="node28" href="keystore_8c.html#a5192f320ce5afdac99056c1e06ad771f" title="ecryptfs_get_auth_tok_sig" alt="" coords="901,680,1075,707"/><area shape="rect" id="node29" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="697,789,826,830"/><area shape="rect" id="node35" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="685,495,838,537"/><area shape="rect" id="node41" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="678,613,845,654"/><area shape="rect" id="node44" href="list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title="list_del" alt="" coords="957,979,1019,1005"/><area shape="rect" id="node46" href="crypto_8c.html#a010c33619300979023e302badcdbd3b5" title="ecryptfs_compute_root_iv" alt="" coords="675,31,847,57"/><area shape="rect" id="node48" href="keystore_8c.html#a90a8b7a243cf75059dfee4f58aed97a2" title="wipe_auth_tok_list" alt="" coords="696,905,827,932"/><area shape="rect" id="node16" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="1155,222,1309,263"/><area shape="rect" id="node17" href="crypto_8c.html#a9ec4f1a07858b147d07a4691fccc9741" title="ecryptfs_cipher_code\l_to_string" alt="" coords="915,361,1061,402"/><area shape="rect" id="node20" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="955,157,1021,184"/><area shape="rect" id="node19" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="1161,302,1303,343"/><area shape="rect" id="node21" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="1191,157,1273,184"/><area shape="rect" id="node27" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="920,528,1056,555"/><area shape="rect" id="node30" href="keystore_8c.html#a2a70f7a5ff64535e0cb220b179e1982f" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="919,847,1057,889"/><area shape="rect" id="node31" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="913,913,1063,954"/><area shape="rect" id="node32" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="1148,949,1316,976"/><area shape="rect" id="node33" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="1129,848,1335,875"/><area shape="rect" id="node34" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="1153,899,1311,925"/><area shape="rect" id="node36" href="keystore_8c.html#a139436651ca07d4aa32396fbae14d1f9" title="write_tag_64_packet" alt="" coords="917,477,1059,504"/><area shape="rect" id="node38" href="ecryptfs__kernel_8h.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="906,579,1070,605"/><area shape="rect" id="node39" href="ecryptfs__kernel_8h.html#a69946a18f3a52d43a34a76f700dea047" title="ecryptfs_wait_for_response" alt="" coords="897,629,1079,656"/><area shape="rect" id="node40" href="keystore_8c.html#a01fe01b7c058e56d355ac11eca7a3749" title="parse_tag_65_packet" alt="" coords="915,427,1061,453"/><area shape="rect" id="node37" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="1157,470,1307,511"/><area shape="rect" id="node42" href="crypto_8c.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="904,782,1072,823"/><area shape="rect" id="node43" href="crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="927,731,1049,757"/><area shape="rect" id="node45" href="list_8h.html#a24b474717d65a296695e8b79b4adefda" title="__list_del" alt="" coords="1193,1000,1271,1027"/><area shape="rect" id="node47" href="crypto_8c.html#afe9ebb3f8af0e14969d856f179bccc8d" title="ecryptfs_calculate_md5" alt="" coords="908,5,1068,32"/><area shape="rect" id="node50" href="ecryptfs__kernel_8h.html#a0db90fed68f8445f1edba3136bc2b11a" title="ecryptfs_getxattr_lower" alt="" coords="458,255,617,281"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a0f476d4db45796bb804042157fbd93fa_icgraph.png" border="0" usemap="#crypto_8c_a0f476d4db45796bb804042157fbd93fa_icgraph" alt=""/></div>
<map name="crypto_8c_a0f476d4db45796bb804042157fbd93fa_icgraph" id="crypto_8c_a0f476d4db45796bb804042157fbd93fa_icgraph">
<area shape="rect" id="node2" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="221,5,325,32"/><area shape="rect" id="node3" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="217,56,330,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0328356e623d00183afc5c85cc63e932"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_read_xattr_region </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>page_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct inode *&#160;</td>
          <td class="paramname"><em>ecryptfs_inode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_read_xattr_region : The vitual address into which to read the xattr data : The eCryptfs inode</p>
<p>Attempts to read the crypto metadata from the extended attribute region of the lower file.</p>
<p>Returns zero on success; non-zero on error </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01765">1765</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a0328356e623d00183afc5c85cc63e932_cgraph.png" border="0" usemap="#crypto_8c_a0328356e623d00183afc5c85cc63e932_cgraph" alt=""/></div>
<map name="crypto_8c_a0328356e623d00183afc5c85cc63e932_cgraph" id="crypto_8c_a0328356e623d00183afc5c85cc63e932_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="189,5,360,32"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a0db90fed68f8445f1edba3136bc2b11a" title="ecryptfs_getxattr_lower" alt="" coords="195,56,354,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a0328356e623d00183afc5c85cc63e932_icgraph.png" border="0" usemap="#crypto_8c_a0328356e623d00183afc5c85cc63e932_icgraph" alt=""/></div>
<map name="crypto_8c_a0328356e623d00183afc5c85cc63e932_icgraph" id="crypto_8c_a0328356e623d00183afc5c85cc63e932_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ade462ad60d1c69a5246f7623f09374a1" title="ecryptfs_read_and_validate\l_xattr_region" alt="" coords="193,15,375,57"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="203,92,365,119"/><area shape="rect" id="node8" href="mmap_8c.html#a71adfacc67a2f9b01c0680e05f5a2a73" title="ecryptfs_copy_up_encrypted\l_with_header" alt="" coords="189,165,379,206"/><area shape="rect" id="node3" href="inode_8c.html#ad1f58d0fd3b46f3063934fe8f6513f45" title="ecryptfs_lookup_and\l_interpose_lower" alt="" coords="427,5,570,46"/><area shape="rect" id="node4" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="629,12,744,39"/><area shape="rect" id="node6" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="447,71,551,97"/><area shape="rect" id="node7" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="442,121,555,148"/><area shape="rect" id="node9" href="mmap_8c.html#a8f8e487f41eae0bd59f0f73483c8b0bd" title="ecryptfs_readpage" alt="" coords="434,172,563,199"/><area shape="rect" id="node11" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="427,223,570,249"/><area shape="rect" id="node10" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="619,172,755,199"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a43a35c67336e7e2dc9545638ffedda7e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ecryptfs_set_default_crypt_stat_vals </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_set_default_crypt_stat_vals : The inode's cryptographic context : The mount point's cryptographic context</p>
<p>Default values in the event that policy does not override them. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01192">1192</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a43a35c67336e7e2dc9545638ffedda7e_cgraph.png" border="0" usemap="#crypto_8c_a43a35c67336e7e2dc9545638ffedda7e_cgraph" alt=""/></div>
<map name="crypto_8c_a43a35c67336e7e2dc9545638ffedda7e_cgraph" id="crypto_8c_a43a35c67336e7e2dc9545638ffedda7e_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a4c1f20c33cc83c9fae00176557a101d2" title="ecryptfs_copy_mount\l_wide_flags_to_inode_flags" alt="" coords="195,5,378,46"/><area shape="rect" id="node3" href="crypto_8c.html#ae0c1e94df9a9186bb509360c1476c353" title="ecryptfs_set_default\l_sizes" alt="" coords="217,70,357,111"/><area shape="rect" id="node4" href="crypto_8c.html#a021875e559b602a9bd59ef32416337dc" title="set_extent_mask_and\l_shift" alt="" coords="427,70,578,111"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a43a35c67336e7e2dc9545638ffedda7e_icgraph.png" border="0" usemap="#crypto_8c_a43a35c67336e7e2dc9545638ffedda7e_icgraph" alt=""/></div>
<map name="crypto_8c_a43a35c67336e7e2dc9545638ffedda7e_icgraph" id="crypto_8c_a43a35c67336e7e2dc9545638ffedda7e_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="195,12,370,39"/><area shape="rect" id="node3" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="419,12,565,39"/><area shape="rect" id="node4" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="613,12,725,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae0c1e94df9a9186bb509360c1476c353"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_set_default_sizes </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01065">1065</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ae0c1e94df9a9186bb509360c1476c353_cgraph.png" border="0" usemap="#crypto_8c_ae0c1e94df9a9186bb509360c1476c353_cgraph" alt=""/></div>
<map name="crypto_8c_ae0c1e94df9a9186bb509360c1476c353_cgraph" id="crypto_8c_ae0c1e94df9a9186bb509360c1476c353_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a021875e559b602a9bd59ef32416337dc" title="set_extent_mask_and\l_shift" alt="" coords="195,5,346,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ae0c1e94df9a9186bb509360c1476c353_icgraph.png" border="0" usemap="#crypto_8c_ae0c1e94df9a9186bb509360c1476c353_icgraph" alt=""/></div>
<map name="crypto_8c_ae0c1e94df9a9186bb509360c1476c353_icgraph" id="crypto_8c_ae0c1e94df9a9186bb509360c1476c353_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a43a35c67336e7e2dc9545638ffedda7e" title="ecryptfs_set_default\l_crypt_stat_vals" alt="" coords="214,6,354,47"/><area shape="rect" id="node6" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="195,72,373,99"/><area shape="rect" id="node10" href="inode_8c.html#ad1f58d0fd3b46f3063934fe8f6513f45" title="ecryptfs_lookup_and\l_interpose_lower" alt="" coords="213,123,355,165"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="422,13,597,40"/><area shape="rect" id="node4" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="645,13,792,40"/><area shape="rect" id="node5" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="840,13,952,40"/><area shape="rect" id="node7" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="428,72,591,99"/><area shape="rect" id="node8" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="667,68,771,95"/><area shape="rect" id="node9" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="662,119,775,145"/><area shape="rect" id="node11" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="452,131,567,157"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a546635bf3080054059b6f8cef79ca4c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_tfm_exists </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cipher_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__key__tfm.html">ecryptfs_key_tfm</a> **&#160;</td>
          <td class="paramname"><em>key_tfm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_tfm_exists - Search for existing tfm for cipher_name. : the name of the cipher to search for : set to corresponding tfm if found</p>
<p>Searches for cached key_tfm matching  Must be called with &amp;key_tfm_list_mutex held Returns 1 if found, with  set Returns 0 if not found, with  set to NULL </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02109">2109</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a546635bf3080054059b6f8cef79ca4c1_icgraph.png" border="0" usemap="#crypto_8c_a546635bf3080054059b6f8cef79ca4c1_icgraph" alt=""/></div>
<map name="crypto_8c_a546635bf3080054059b6f8cef79ca4c1_icgraph" id="crypto_8c_a546635bf3080054059b6f8cef79ca4c1_icgraph">
<area shape="rect" id="node2" href="services_2gaes_2ecryptfs_2main_8c.html#ad2a806cb5b6290a55a1d14c514ac0590" title="ecryptfs_parse_options" alt="" coords="197,89,355,116"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="192,173,360,214"/><area shape="rect" id="node3" href="services_2gaes_2ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="436,56,548,83"/><area shape="rect" id="node5" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="427,107,557,149"/><area shape="rect" id="node10" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="425,173,559,214"/><area shape="rect" id="node17" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="409,239,575,281"/><area shape="rect" id="node23" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="425,307,559,333"/><area shape="rect" id="node6" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="626,112,801,139"/><area shape="rect" id="node7" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="869,49,1016,90"/><area shape="rect" id="node8" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="1108,5,1223,32"/><area shape="rect" id="node9" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1105,56,1226,83"/><area shape="rect" id="node11" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="640,166,787,207"/><area shape="rect" id="node12" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="891,121,994,148"/><area shape="rect" id="node14" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="863,173,1022,200"/><area shape="rect" id="node13" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="1108,107,1223,133"/><area shape="rect" id="node15" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="1105,157,1226,184"/><area shape="rect" id="node16" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="1095,208,1235,235"/><area shape="rect" id="node18" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="624,247,803,273"/><area shape="rect" id="node19" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="853,253,1032,280"/><area shape="rect" id="node20" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1084,259,1247,285"/><area shape="rect" id="node21" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1317,208,1421,235"/><area shape="rect" id="node22" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1313,259,1426,285"/><area shape="rect" id="node24" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="636,299,791,341"/><area shape="rect" id="node25" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="851,309,1034,336"/><area shape="rect" id="node26" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="1083,309,1248,336"/><area shape="rect" id="node27" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1296,309,1443,336"/><area shape="rect" id="node28" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1491,309,1603,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a600a433968f0fca6c59d0503e4a13adc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_to_hex </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>src_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_to_hex : Buffer to take hex character representation of contents of src; must be at least of size (src_size * 2) : Buffer to be converted to a hex string respresentation : number of bytes to convert </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00068">68</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a600a433968f0fca6c59d0503e4a13adc_icgraph.png" border="0" usemap="#crypto_8c_a600a433968f0fca6c59d0503e4a13adc_icgraph" alt=""/></div>
<map name="crypto_8c_a600a433968f0fca6c59d0503e4a13adc_icgraph" id="crypto_8c_a600a433968f0fca6c59d0503e4a13adc_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a77caaec801939ef76ff0cb3c11e529b4" title="ecryptfs_dump_auth_tok" alt="" coords="168,5,333,32"/><area shape="rect" id="node3" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="381,56,560,83"/><area shape="rect" id="node8" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="184,158,317,199"/><area shape="rect" id="node15" href="keystore_8c.html#ac0f59c651d74024aedd73031beadeca5" title="parse_tag_1_packet" alt="" coords="181,107,320,133"/><area shape="rect" id="node4" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="608,56,787,83"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="835,56,997,83"/><area shape="rect" id="node6" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1051,31,1155,57"/><area shape="rect" id="node7" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1046,81,1159,108"/><area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="397,158,544,199"/><area shape="rect" id="node10" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="646,140,749,167"/><area shape="rect" id="node12" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="618,191,777,217"/><area shape="rect" id="node11" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="859,140,973,167"/><area shape="rect" id="node13" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="855,191,977,217"/><area shape="rect" id="node14" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="846,241,986,268"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a50ad608c942c06e27fb6759d031cb1bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_write_crypt_stat_flags </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>page_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>written</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01346">1346</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a50ad608c942c06e27fb6759d031cb1bc_icgraph.png" border="0" usemap="#crypto_8c_a50ad608c942c06e27fb6759d031cb1bc_icgraph" alt=""/></div>
<map name="crypto_8c_a50ad608c942c06e27fb6759d031cb1bc_icgraph" id="crypto_8c_a50ad608c942c06e27fb6759d031cb1bc_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="195,8,378,35"/><area shape="rect" id="node6" href="mmap_8c.html#adc61f37e04f31bbf3dce9ad8b242108e" title="strip_xattr_flag" alt="" coords="233,60,341,87"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="439,5,604,32"/><area shape="rect" id="node4" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="664,5,811,32"/><area shape="rect" id="node5" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="871,5,983,32"/><area shape="rect" id="node7" href="mmap_8c.html#a71adfacc67a2f9b01c0680e05f5a2a73" title="ecryptfs_copy_up_encrypted\l_with_header" alt="" coords="427,57,616,98"/><area shape="rect" id="node8" href="mmap_8c.html#a8f8e487f41eae0bd59f0f73483c8b0bd" title="ecryptfs_readpage" alt="" coords="673,60,802,87"/><area shape="rect" id="node10" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="666,111,809,137"/><area shape="rect" id="node9" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="859,60,995,87"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a897cc3b03edffb1e113ad7aa251cd365"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecryptfs_write_header_metadata </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>written</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01467">1467</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a897cc3b03edffb1e113ad7aa251cd365_icgraph.png" border="0" usemap="#crypto_8c_a897cc3b03edffb1e113ad7aa251cd365_icgraph" alt=""/></div>
<map name="crypto_8c_a897cc3b03edffb1e113ad7aa251cd365_icgraph" id="crypto_8c_a897cc3b03edffb1e113ad7aa251cd365_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="209,5,391,32"/><area shape="rect" id="node6" href="mmap_8c.html#a71adfacc67a2f9b01c0680e05f5a2a73" title="ecryptfs_copy_up_encrypted\l_with_header" alt="" coords="205,57,395,98"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="443,5,608,32"/><area shape="rect" id="node4" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="656,5,803,32"/><area shape="rect" id="node5" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="851,5,963,32"/><area shape="rect" id="node7" href="mmap_8c.html#a8f8e487f41eae0bd59f0f73483c8b0bd" title="ecryptfs_readpage" alt="" coords="461,60,590,87"/><area shape="rect" id="node9" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="454,111,597,137"/><area shape="rect" id="node8" href="mmap_8c.html#a817586e3c9558932635e84f23bbe3980" title="ecryptfs_readpages" alt="" coords="661,60,797,87"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a726219be3d26c0f5d0cd3764aaf1dc10"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_write_headers_virt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>page_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_write_headers_virt : The virtual address to write the headers to : The size of memory allocated at page_virt : Set to the number of bytes written by this function : The cryptographic context : The eCryptfs dentry</p>
<p>Format version: 1</p>
<p>Header Extent: Octets 0-7: Unencrypted file size (big-endian) Octets 8-15: eCryptfs special marker Octets 16-19: Flags Octet 16: File format version number (between 0 and 255) Octets 17-18: Reserved Octet 19: Bit 1 (lsb): Reserved Bit 2: Encrypted? Bits 3-8: Reserved Octets 20-23: Header extent size (big-endian) Octets 24-25: Number of header extents at front of file (big-endian) Octet 26: Begin RFC 2440 authentication token packet set Data Extent 0: Lower data (CBC encrypted) Data Extent 1: Lower data (CBC encrypted) ...</p>
<p>Returns zero on success </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01517">1517</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a726219be3d26c0f5d0cd3764aaf1dc10_cgraph.png" border="0" usemap="#crypto_8c_a726219be3d26c0f5d0cd3764aaf1dc10_cgraph" alt=""/></div>
<map name="crypto_8c_a726219be3d26c0f5d0cd3764aaf1dc10_cgraph" id="crypto_8c_a726219be3d26c0f5d0cd3764aaf1dc10_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a896178cbcc9f09e6954fc88c6652a8b8" title="write_ecryptfs_marker" alt="" coords="239,63,390,89"/><area shape="rect" id="node3" href="crypto_8c.html#a50ad608c942c06e27fb6759d031cb1bc" title="ecryptfs_write_crypt\l_stat_flags" alt="" coords="245,114,385,155"/><area shape="rect" id="node4" href="crypto_8c.html#a897cc3b03edffb1e113ad7aa251cd365" title="ecryptfs_write_header\l_metadata" alt="" coords="239,179,390,221"/><area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="237,245,392,286"/><area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#ab0987a55f9bd100b72e69f9dc54d1e39" title="ecryptfs_superblock\l_to_private" alt="" coords="443,121,581,162"/><area shape="rect" id="node7" href="keystore_8c.html#a2a70f7a5ff64535e0cb220b179e1982f" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="443,186,581,227"/><area shape="rect" id="node8" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="445,328,579,355"/><area shape="rect" id="node21" href="keystore_8c.html#aa635b6e3a4e2bc10bc02d2a3d6636fa9" title="write_tag_11_packet" alt="" coords="441,463,583,489"/><area shape="rect" id="node22" href="keystore_8c.html#ac6bc314de94c6d266926cc7dc0219c5b" title="write_tag_1_packet" alt="" coords="445,252,579,279"/><area shape="rect" id="node9" href="crypto_8c.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="652,277,783,304"/><area shape="rect" id="node10" href="crypto_8c.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="633,481,801,522"/><area shape="rect" id="node17" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="649,227,785,253"/><area shape="rect" id="node18" href="crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="656,429,779,456"/><area shape="rect" id="node19" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="1090,329,1241,370"/><area shape="rect" id="node20" href="crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="859,227,1027,269"/><area shape="rect" id="node11" href="crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="874,488,1011,515"/><area shape="rect" id="node12" href="crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="851,597,1034,624"/><area shape="rect" id="node13" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25" title="ecryptfs_process_key\l_cipher" alt="" coords="1090,590,1241,631"/><area shape="rect" id="node15" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="1516,485,1583,512"/><area shape="rect" id="node14" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="1305,590,1447,631"/><area shape="rect" id="node16" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="1643,456,1725,483"/><area shape="rect" id="node23" href="keystore_8c.html#a2bfafae46d434c6ccc87ec04ee2e9db4" title="pki_encrypt_session_key" alt="" coords="633,125,802,152"/><area shape="rect" id="node24" href="keystore_8c.html#a98ebf885256c3ac84ee176459d46455c" title="write_tag_66_packet" alt="" coords="871,176,1014,203"/><area shape="rect" id="node25" href="ecryptfs__kernel_8h.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="861,125,1025,152"/><area shape="rect" id="node33" href="ecryptfs__kernel_8h.html#a69946a18f3a52d43a34a76f700dea047" title="ecryptfs_wait_for_response" alt="" coords="851,20,1034,47"/><area shape="rect" id="node35" href="keystore_8c.html#ae69ad5279272fb61e4b704482e2ba126" title="parse_tag_67_packet" alt="" coords="869,75,1016,101"/><area shape="rect" id="node26" href="messaging_8c.html#a10730ea01271b89e1dbd74f64cff553f" title="ecryptfs_send_message\l_locked" alt="" coords="1083,238,1247,279"/><area shape="rect" id="node27" href="messaging_8c.html#a785e6d04b5b757664a8c0d7e48bbf5ee" title="ecryptfs_find_daemon\l_by_euid" alt="" coords="1301,173,1451,214"/><area shape="rect" id="node28" href="messaging_8c.html#a3cf131d292b1e79c317132d722ad3bb3" title="ecryptfs_acquire_free\l_msg_ctx" alt="" coords="1303,238,1449,279"/><area shape="rect" id="node30" href="messaging_8c.html#a4e5308be4f4821f928b20d7469c21267" title="ecryptfs_msg_ctx_free\l_to_alloc" alt="" coords="1299,303,1453,345"/><area shape="rect" id="node31" href="ecryptfs__kernel_8h.html#a6daf51b4a7c7274ac0e7e7beeeab775d" title="ecryptfs_send_miscdev" alt="" coords="1296,407,1456,433"/><area shape="rect" id="node29" href="list_8h.html#a6601e54d8f27ab290ee6819f7e2127b7" title="list_empty" alt="" coords="1508,245,1591,272"/><area shape="rect" id="node32" href="list_8h.html#a588bec046f1e9797b33a5c5ab250f447" title="list_add_tail" alt="" coords="1504,425,1595,452"/><area shape="rect" id="node34" href="messaging_8c.html#afa5f0c6e4ccfb9753a323ff2c5ae993c" title="ecryptfs_msg_ctx_alloc\l_to_free" alt="" coords="1085,6,1245,47"/><area shape="rect" id="node36" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="1088,71,1243,113"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a726219be3d26c0f5d0cd3764aaf1dc10_icgraph.png" border="0" usemap="#crypto_8c_a726219be3d26c0f5d0cd3764aaf1dc10_icgraph" alt=""/></div>
<map name="crypto_8c_a726219be3d26c0f5d0cd3764aaf1dc10_icgraph" id="crypto_8c_a726219be3d26c0f5d0cd3764aaf1dc10_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="237,5,403,32"/><area shape="rect" id="node3" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="451,5,597,32"/><area shape="rect" id="node4" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="645,5,757,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aebe428f37c6e93d1e18cdc4a7b40e1f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_write_metadata </td>
          <td>(</td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_write_metadata : The eCryptfs dentry</p>
<p>Write the file headers out. This will likely involve a userspace callout, in which the session key is encrypted with one or more public keys and/or the passphrase necessary to do the encryption is retrieved via a prompt. Exactly what happens at this point should be policy-dependent.</p>
<p>Returns zero on success; non-zero on error </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01598">1598</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_aebe428f37c6e93d1e18cdc4a7b40e1f6_cgraph.png" border="0" usemap="#crypto_8c_aebe428f37c6e93d1e18cdc4a7b40e1f6_cgraph" alt=""/></div>
<map name="crypto_8c_aebe428f37c6e93d1e18cdc4a7b40e1f6_cgraph" id="crypto_8c_aebe428f37c6e93d1e18cdc4a7b40e1f6_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="653,167,824,193"/><area shape="rect" id="node3" href="crypto_8c.html#ac0f2f172cce958308b370bfd82334710" title="ecryptfs_get_zeroed\l_pages" alt="" coords="241,265,381,306"/><area shape="rect" id="node4" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="219,331,402,357"/><area shape="rect" id="node40" href="crypto_8c.html#a5af3e655459e9f1bc093c1bcaab4cb26" title="ecryptfs_write_metadata\l_to_xattr" alt="" coords="228,459,393,501"/><area shape="rect" id="node43" href="crypto_8c.html#ace3f04fde63f77ad0f5161ccdf102f8b" title="ecryptfs_write_metadata\l_to_contents" alt="" coords="228,199,393,241"/><area shape="rect" id="node5" href="crypto_8c.html#a896178cbcc9f09e6954fc88c6652a8b8" title="write_ecryptfs_marker" alt="" coords="453,249,603,276"/><area shape="rect" id="node6" href="crypto_8c.html#a50ad608c942c06e27fb6759d031cb1bc" title="ecryptfs_write_crypt\l_stat_flags" alt="" coords="458,301,598,342"/><area shape="rect" id="node7" href="crypto_8c.html#a897cc3b03edffb1e113ad7aa251cd365" title="ecryptfs_write_header\l_metadata" alt="" coords="453,366,603,407"/><area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="451,431,605,473"/><area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#ab0987a55f9bd100b72e69f9dc54d1e39" title="ecryptfs_superblock\l_to_private" alt="" coords="669,457,808,498"/><area shape="rect" id="node10" href="keystore_8c.html#a2a70f7a5ff64535e0cb220b179e1982f" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="669,522,808,563"/><area shape="rect" id="node11" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="671,355,806,381"/><area shape="rect" id="node24" href="keystore_8c.html#aa635b6e3a4e2bc10bc02d2a3d6636fa9" title="write_tag_11_packet" alt="" coords="886,547,1029,573"/><area shape="rect" id="node25" href="keystore_8c.html#ac6bc314de94c6d266926cc7dc0219c5b" title="write_tag_1_packet" alt="" coords="671,227,806,253"/><area shape="rect" id="node12" href="crypto_8c.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="892,277,1023,304"/><area shape="rect" id="node13" href="crypto_8c.html#af479d34da23aa4c6382373fdce1f7bbf" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="873,481,1041,522"/><area shape="rect" id="node20" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="889,227,1025,253"/><area shape="rect" id="node21" href="crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="896,429,1019,456"/><area shape="rect" id="node22" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="1330,363,1481,405"/><area shape="rect" id="node23" href="crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="1099,227,1267,269"/><area shape="rect" id="node14" href="crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="1114,429,1251,456"/><area shape="rect" id="node15" href="crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="1091,531,1274,557"/><area shape="rect" id="node16" href="crypto_8c.html#a89e7a8582efdfa475ae354125c5abb25" title="ecryptfs_process_key\l_cipher" alt="" coords="1330,523,1481,565"/><area shape="rect" id="node18" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="list_add" alt="" coords="1756,457,1823,484"/><area shape="rect" id="node17" href="crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="1545,523,1687,565"/><area shape="rect" id="node19" href="list_8h.html#a8a28f150a191624bf6923a48cdace7e3" title="__list_add" alt="" coords="1883,423,1965,449"/><area shape="rect" id="node26" href="keystore_8c.html#a2bfafae46d434c6ccc87ec04ee2e9db4" title="pki_encrypt_session_key" alt="" coords="873,125,1042,152"/><area shape="rect" id="node27" href="keystore_8c.html#a98ebf885256c3ac84ee176459d46455c" title="write_tag_66_packet" alt="" coords="1111,176,1254,203"/><area shape="rect" id="node28" href="ecryptfs__kernel_8h.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="1101,125,1265,152"/><area shape="rect" id="node36" href="ecryptfs__kernel_8h.html#a69946a18f3a52d43a34a76f700dea047" title="ecryptfs_wait_for_response" alt="" coords="1091,75,1274,101"/><area shape="rect" id="node38" href="keystore_8c.html#ae69ad5279272fb61e4b704482e2ba126" title="parse_tag_67_packet" alt="" coords="1109,17,1256,44"/><area shape="rect" id="node29" href="messaging_8c.html#a10730ea01271b89e1dbd74f64cff553f" title="ecryptfs_send_message\l_locked" alt="" coords="1323,142,1487,183"/><area shape="rect" id="node30" href="messaging_8c.html#a785e6d04b5b757664a8c0d7e48bbf5ee" title="ecryptfs_find_daemon\l_by_euid" alt="" coords="1541,207,1691,249"/><area shape="rect" id="node31" href="messaging_8c.html#a3cf131d292b1e79c317132d722ad3bb3" title="ecryptfs_acquire_free\l_msg_ctx" alt="" coords="1543,77,1689,118"/><area shape="rect" id="node33" href="messaging_8c.html#a4e5308be4f4821f928b20d7469c21267" title="ecryptfs_msg_ctx_free\l_to_alloc" alt="" coords="1539,142,1693,183"/><area shape="rect" id="node34" href="ecryptfs__kernel_8h.html#a6daf51b4a7c7274ac0e7e7beeeab775d" title="ecryptfs_send_miscdev" alt="" coords="1536,349,1696,376"/><area shape="rect" id="node32" href="list_8h.html#a6601e54d8f27ab290ee6819f7e2127b7" title="list_empty" alt="" coords="1748,84,1831,111"/><area shape="rect" id="node35" href="list_8h.html#a588bec046f1e9797b33a5c5ab250f447" title="list_add_tail" alt="" coords="1744,388,1835,415"/><area shape="rect" id="node37" href="messaging_8c.html#afa5f0c6e4ccfb9753a323ff2c5ae993c" title="ecryptfs_msg_ctx_alloc\l_to_free" alt="" coords="1325,71,1485,113"/><area shape="rect" id="node39" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="1328,6,1483,47"/><area shape="rect" id="node41" href="ecryptfs__kernel_8h.html#abbdcc9bb9c767d89ccc0a083fc44cc0b" title="ecryptfs_setxattr" alt="" coords="468,544,588,571"/><area shape="rect" id="node42" href="ecryptfs__kernel_8h.html#ac2ee045a66c2ebc91f8a5dbc00570d95" title="ecryptfs_dentry_to\l_lower" alt="" coords="673,587,804,629"/><area shape="rect" id="node44" href="ecryptfs__kernel_8h.html#abcca60d451f0a0e8ae33d8738d662fd7" title="ecryptfs_write_lower" alt="" coords="457,199,599,225"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_aebe428f37c6e93d1e18cdc4a7b40e1f6_icgraph.png" border="0" usemap="#crypto_8c_aebe428f37c6e93d1e18cdc4a7b40e1f6_icgraph" alt=""/></div>
<map name="crypto_8c_aebe428f37c6e93d1e18cdc4a7b40e1f6_icgraph" id="crypto_8c_aebe428f37c6e93d1e18cdc4a7b40e1f6_icgraph">
<area shape="rect" id="node2" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="219,5,365,32"/><area shape="rect" id="node3" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="413,5,525,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace3f04fde63f77ad0f5161ccdf102f8b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_write_metadata_to_contents </td>
          <td>(</td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>virt_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01549">1549</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ace3f04fde63f77ad0f5161ccdf102f8b_cgraph.png" border="0" usemap="#crypto_8c_ace3f04fde63f77ad0f5161ccdf102f8b_cgraph" alt=""/></div>
<map name="crypto_8c_ace3f04fde63f77ad0f5161ccdf102f8b_cgraph" id="crypto_8c_ace3f04fde63f77ad0f5161ccdf102f8b_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#abcca60d451f0a0e8ae33d8738d662fd7" title="ecryptfs_write_lower" alt="" coords="219,12,362,39"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a5240470a17155c25d11458eb2504a7ab" title="ecryptfs_inode_to_private" alt="" coords="411,12,581,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_ace3f04fde63f77ad0f5161ccdf102f8b_icgraph.png" border="0" usemap="#crypto_8c_ace3f04fde63f77ad0f5161ccdf102f8b_icgraph" alt=""/></div>
<map name="crypto_8c_ace3f04fde63f77ad0f5161ccdf102f8b_icgraph" id="crypto_8c_ace3f04fde63f77ad0f5161ccdf102f8b_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="219,12,384,39"/><area shape="rect" id="node3" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="432,12,579,39"/><area shape="rect" id="node4" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="627,12,739,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5af3e655459e9f1bc093c1bcaab4cb26"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_write_metadata_to_xattr </td>
          <td>(</td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>page_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01565">1565</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a5af3e655459e9f1bc093c1bcaab4cb26_cgraph.png" border="0" usemap="#crypto_8c_a5af3e655459e9f1bc093c1bcaab4cb26_cgraph" alt=""/></div>
<map name="crypto_8c_a5af3e655459e9f1bc093c1bcaab4cb26_cgraph" id="crypto_8c_a5af3e655459e9f1bc093c1bcaab4cb26_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#abbdcc9bb9c767d89ccc0a083fc44cc0b" title="ecryptfs_setxattr" alt="" coords="219,12,339,39"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#ac2ee045a66c2ebc91f8a5dbc00570d95" title="ecryptfs_dentry_to\l_lower" alt="" coords="387,5,517,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a5af3e655459e9f1bc093c1bcaab4cb26_icgraph.png" border="0" usemap="#crypto_8c_a5af3e655459e9f1bc093c1bcaab4cb26_icgraph" alt=""/></div>
<map name="crypto_8c_a5af3e655459e9f1bc093c1bcaab4cb26_icgraph" id="crypto_8c_a5af3e655459e9f1bc093c1bcaab4cb26_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="219,12,384,39"/><area shape="rect" id="node3" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="432,12,579,39"/><area shape="rect" id="node4" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="627,12,739,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2557a0d17ec106c3b524579a1a68c17b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int encrypt_scatterlist </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct scatterlist *&#160;</td>
          <td class="paramname"><em>dest_sg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct scatterlist *&#160;</td>
          <td class="paramname"><em>src_sg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>encrypt_scatterlist : Pointer to the crypt_stat struct to initialize. : Destination of encrypted data : Data to be encrypted : Length of data to be encrypted : iv to use during encryption</p>
<p>Returns the number of bytes encrypted; negative value on error </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00346">346</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a2557a0d17ec106c3b524579a1a68c17b_cgraph.png" border="0" usemap="#crypto_8c_a2557a0d17ec106c3b524579a1a68c17b_cgraph" alt=""/></div>
<map name="crypto_8c_a2557a0d17ec106c3b524579a1a68c17b_cgraph" id="crypto_8c_a2557a0d17ec106c3b524579a1a68c17b_cgraph">
<area shape="rect" id="node2" href="debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="184,5,320,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a2557a0d17ec106c3b524579a1a68c17b_icgraph.png" border="0" usemap="#crypto_8c_a2557a0d17ec106c3b524579a1a68c17b_icgraph" alt=""/></div>
<map name="crypto_8c_a2557a0d17ec106c3b524579a1a68c17b_icgraph" id="crypto_8c_a2557a0d17ec106c3b524579a1a68c17b_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a83ba6402513da64241081017b40210f9" title="ecryptfs_encrypt_pages" alt="" coords="187,5,349,32"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a9ea5ca17a37e818f2bb40976b23adb9c" title="ecryptfs_encrypt_pages2" alt="" coords="184,56,352,83"/><area shape="rect" id="node7" href="crypto_8c.html#a4edeaa3bc6ab6aaf996f7a8c002c74a1" title="ecryptfs_encrypt_page\l_offset" alt="" coords="191,107,345,149"/><area shape="rect" id="node3" href="mmap_8c.html#a6271dcf41ac10f0950eddf5c10a9d0f6" title="ecryptfs_writepages" alt="" coords="412,5,551,32"/><area shape="rect" id="node5" href="read__write_8c.html#a7069e6270fd6afd0bb49e7259cd74810" title="ecryptfs_write2" alt="" coords="426,56,537,83"/><area shape="rect" id="node6" href="file_8c.html#a728728ea4482c58bb7b9cabbc7bfcd3f" title="ecryptfs_file_write" alt="" coords="624,56,752,83"/><area shape="rect" id="node8" href="crypto_8c.html#a667352484e3769a93d4d6756207a6294" title="ecryptfs_encrypt_extent" alt="" coords="400,115,563,141"/><area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#a26de129ca477fc9762d6750b5020914f" title="ecryptfs_encrypt_page" alt="" coords="611,115,765,141"/><area shape="rect" id="node10" href="mmap_8c.html#a1c709c67cbb144bffe29cff5a7ac0f8c" title="ecryptfs_writepage" alt="" coords="814,64,946,91"/><area shape="rect" id="node11" href="mmap_8c.html#aba2c17cca4323636c254626963421f3f" title="ecryptfs_write_end" alt="" coords="814,115,946,141"/><area shape="rect" id="node12" href="read__write_8c.html#a1f6fb7e71433ccea976b2cba69741f2a" title="ecryptfs_write" alt="" coords="828,165,932,192"/><area shape="rect" id="node13" href="inode_8c.html#a01b49555f54fc75f2ce9382cee60155e" title="grow_file" alt="" coords="1012,140,1087,167"/><area shape="rect" id="node16" href="inode_8c.html#a6d535560db4f881686903ff564b74faf" title="truncate_upper" alt="" coords="995,191,1103,217"/><area shape="rect" id="node14" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1152,140,1299,167"/><area shape="rect" id="node15" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1363,140,1475,167"/><area shape="rect" id="node17" href="inode_8c.html#ae6d4593f3f6d169ca3ecc1a07550cec1" title="ecryptfs_truncate" alt="" coords="1164,191,1287,217"/><area shape="rect" id="node19" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1169,241,1282,268"/><area shape="rect" id="node18" href="mmap_8c.html#a6a4799f05bb0baa6b8d31732c51a633f" title="ecryptfs_write_begin" alt="" coords="1347,191,1490,217"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abc63e296860a38dd41bb90bd8bbcde51"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parse_header_metadata </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bytes_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>validate_header_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01655">1655</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_abc63e296860a38dd41bb90bd8bbcde51_icgraph.png" border="0" usemap="#crypto_8c_abc63e296860a38dd41bb90bd8bbcde51_icgraph" alt=""/></div>
<map name="crypto_8c_abc63e296860a38dd41bb90bd8bbcde51_icgraph" id="crypto_8c_abc63e296860a38dd41bb90bd8bbcde51_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="216,31,395,57"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="443,31,605,57"/><area shape="rect" id="node4" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="659,5,763,32"/><area shape="rect" id="node5" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="654,56,767,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7547fa51803046747c7184904e499062"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_default_header_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>set_default_header_data : The cryptographic context</p>
<p>For version 0 file format; this function is only for backwards compatibility for files created with the prior versions of eCryptfs. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01687">1687</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a7547fa51803046747c7184904e499062_icgraph.png" border="0" usemap="#crypto_8c_a7547fa51803046747c7184904e499062_icgraph" alt=""/></div>
<map name="crypto_8c_a7547fa51803046747c7184904e499062_icgraph" id="crypto_8c_a7547fa51803046747c7184904e499062_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="219,31,397,57"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="445,31,608,57"/><area shape="rect" id="node4" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="661,5,765,32"/><area shape="rect" id="node5" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="657,56,770,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a021875e559b602a9bd59ef32416337dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_extent_mask_and_shift </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01049">1049</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a021875e559b602a9bd59ef32416337dc_icgraph.png" border="0" usemap="#crypto_8c_a021875e559b602a9bd59ef32416337dc_icgraph" alt=""/></div>
<map name="crypto_8c_a021875e559b602a9bd59ef32416337dc_icgraph" id="crypto_8c_a021875e559b602a9bd59ef32416337dc_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ae0c1e94df9a9186bb509360c1476c353" title="ecryptfs_set_default\l_sizes" alt="" coords="206,65,346,106"/><area shape="rect" id="node3" href="crypto_8c.html#a43a35c67336e7e2dc9545638ffedda7e" title="ecryptfs_set_default\l_crypt_stat_vals" alt="" coords="414,6,554,47"/><area shape="rect" id="node7" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="395,72,573,99"/><area shape="rect" id="node11" href="inode_8c.html#ad1f58d0fd3b46f3063934fe8f6513f45" title="ecryptfs_lookup_and\l_interpose_lower" alt="" coords="413,123,555,165"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a9a076756b4a12fe2b1913c58313bed8f" title="ecryptfs_new_file_context" alt="" coords="622,13,797,40"/><area shape="rect" id="node5" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="845,13,992,40"/><area shape="rect" id="node6" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1040,13,1152,40"/><area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="628,72,791,99"/><area shape="rect" id="node9" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="867,68,971,95"/><area shape="rect" id="node10" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="862,119,975,145"/><area shape="rect" id="node12" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="652,131,767,157"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a192ec172108f38b6c893f631d0ed6cc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virt_to_scatterlist </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct scatterlist *&#160;</td>
          <td class="paramname"><em>sg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sg_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>virt_to_scatterlist : Virtual address : Size of data; should be an even multiple of the block size : Pointer to scatterlist array; set to NULL to obtain only the number of scatterlist structs required in array : Max array size</p>
<p>Fills in a scatterlist array with page references for a passed virtual address.</p>
<p>Returns the number of scatterlist structs in array used </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00302">302</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a192ec172108f38b6c893f631d0ed6cc4_icgraph.png" border="0" usemap="#crypto_8c_a192ec172108f38b6c893f631d0ed6cc4_icgraph" alt=""/></div>
<map name="crypto_8c_a192ec172108f38b6c893f631d0ed6cc4_icgraph" id="crypto_8c_a192ec172108f38b6c893f631d0ed6cc4_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="195,107,325,149"/><area shape="rect" id="node7" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="193,174,327,215"/><area shape="rect" id="node14" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="177,241,343,282"/><area shape="rect" id="node20" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="193,307,327,333"/><area shape="rect" id="node3" href="crypto_8c.html#ac05661b742322849b06256613c2ee205" title="ecryptfs_encrypt_filename" alt="" coords="394,112,569,139"/><area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#ab06b8734f2f60f1d0e0a49cea38e4139" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="637,49,784,90"/><area shape="rect" id="node5" href="inode_8c.html#ad77dbfd861f06cd54046a232ce7a5b3b" title="ecryptfs_lookup" alt="" coords="876,5,991,32"/><area shape="rect" id="node6" href="inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="873,56,994,83"/><area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#a93f392b9925fe885ac0d2d74e5146843" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="408,166,555,207"/><area shape="rect" id="node9" href="file_8c.html#aedaa546a81860ed0159a408464edf5f3" title="ecryptfs_filldir" alt="" coords="659,121,762,148"/><area shape="rect" id="node11" href="inode_8c.html#a2e07441e81e432816ec37c3f5718a0a9" title="ecryptfs_readlink_lower" alt="" coords="631,173,790,200"/><area shape="rect" id="node10" href="file_8c.html#a157ee122e9a256f1b7b93edd406fd088" title="ecryptfs_readdir" alt="" coords="876,107,991,133"/><area shape="rect" id="node12" href="inode_8c.html#a02162769d84039ef360069143793ab24" title="ecryptfs_readlink" alt="" coords="873,157,994,184"/><area shape="rect" id="node13" href="inode_8c.html#a55786dfb81de37a34619141a3c7068d6" title="ecryptfs_getattr_link" alt="" coords="863,208,1003,235"/><area shape="rect" id="node15" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="392,248,571,275"/><area shape="rect" id="node16" href="crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="621,253,800,280"/><area shape="rect" id="node17" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="852,259,1015,285"/><area shape="rect" id="node18" href="file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1085,208,1189,235"/><area shape="rect" id="node19" href="inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1081,259,1194,285"/><area shape="rect" id="node21" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="404,299,559,341"/><area shape="rect" id="node22" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="619,309,802,336"/><area shape="rect" id="node23" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="851,309,1016,336"/><area shape="rect" id="node24" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="1064,309,1211,336"/><area shape="rect" id="node25" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="1259,309,1371,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a896178cbcc9f09e6954fc88c6652a8b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void write_ecryptfs_marker </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>page_virt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>written</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>write_ecryptfs_marker : The pointer to in a page to begin writing the marker : Number of bytes written</p>
<p>Marker = 0x3c81b7f5 </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01334">1334</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c_a896178cbcc9f09e6954fc88c6652a8b8_icgraph.png" border="0" usemap="#crypto_8c_a896178cbcc9f09e6954fc88c6652a8b8_icgraph" alt=""/></div>
<map name="crypto_8c_a896178cbcc9f09e6954fc88c6652a8b8_icgraph" id="crypto_8c_a896178cbcc9f09e6954fc88c6652a8b8_icgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="206,5,389,32"/><area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#aebe428f37c6e93d1e18cdc4a7b40e1f6" title="ecryptfs_write_metadata" alt="" coords="437,5,603,32"/><area shape="rect" id="node4" href="inode_8c.html#aa3e69b4fc3ab260970b7852e00b63ac1" title="ecryptfs_initialize_file" alt="" coords="651,5,797,32"/><area shape="rect" id="node5" href="inode_8c.html#a2b00e2205459387d2f180e8f055fbaa6" title="ecryptfs_create" alt="" coords="845,5,957,32"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a9f3bdb4acc333f1c6b712f86275fd5ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structecryptfs__cipher__code__str__map__elem.html">ecryptfs_cipher_code_str_map_elem</a> ecryptfs_cipher_code_str_map[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    {<span class="stringliteral">&quot;aes&quot;</span>,<a class="code" href="ecryptfs__kernel_8h.html#a4328c83a082b18cfaafdc42da24e8583">RFC2440_CIPHER_AES_128</a> },</div>
<div class="line">    {<span class="stringliteral">&quot;blowfish&quot;</span>, <a class="code" href="ecryptfs__kernel_8h.html#a9134b8ab463c9b4be9972dca8ce445d3">RFC2440_CIPHER_BLOWFISH</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;des3_ede&quot;</span>, <a class="code" href="ecryptfs__kernel_8h.html#a42aac160747b7aeb69124423f7dda9cf">RFC2440_CIPHER_DES3_EDE</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;cast5&quot;</span>, <a class="code" href="ecryptfs__kernel_8h.html#aab2497a61698b2b51fcb4e0fad2f0ca3">RFC2440_CIPHER_CAST_5</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;twofish&quot;</span>, <a class="code" href="ecryptfs__kernel_8h.html#a82208e40f253521b728570377a2df859">RFC2440_CIPHER_TWOFISH</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;cast6&quot;</span>, <a class="code" href="ecryptfs__kernel_8h.html#ace74b19d0df31c4e067178a28f10d906">RFC2440_CIPHER_CAST_6</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;aes&quot;</span>, <a class="code" href="ecryptfs__kernel_8h.html#a8d974e1a159818750ded307bbdfb074b">RFC2440_CIPHER_AES_192</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;aes&quot;</span>, <a class="code" href="ecryptfs__kernel_8h.html#a15205f585ff88ccceaa7e24c3b496cd0">RFC2440_CIPHER_AES_256</a>}</div>
<div class="line">}</div>
<div class="ttc" id="ecryptfs__kernel_8h_html_aab2497a61698b2b51fcb4e0fad2f0ca3"><div class="ttname"><a href="ecryptfs__kernel_8h.html#aab2497a61698b2b51fcb4e0fad2f0ca3">RFC2440_CIPHER_CAST_5</a></div><div class="ttdeci">#define RFC2440_CIPHER_CAST_5</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00095">ecryptfs_kernel.h:95</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a42aac160747b7aeb69124423f7dda9cf"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a42aac160747b7aeb69124423f7dda9cf">RFC2440_CIPHER_DES3_EDE</a></div><div class="ttdeci">#define RFC2440_CIPHER_DES3_EDE</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00094">ecryptfs_kernel.h:94</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a8d974e1a159818750ded307bbdfb074b"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a8d974e1a159818750ded307bbdfb074b">RFC2440_CIPHER_AES_192</a></div><div class="ttdeci">#define RFC2440_CIPHER_AES_192</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00098">ecryptfs_kernel.h:98</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a9134b8ab463c9b4be9972dca8ce445d3"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a9134b8ab463c9b4be9972dca8ce445d3">RFC2440_CIPHER_BLOWFISH</a></div><div class="ttdeci">#define RFC2440_CIPHER_BLOWFISH</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00096">ecryptfs_kernel.h:96</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a4328c83a082b18cfaafdc42da24e8583"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a4328c83a082b18cfaafdc42da24e8583">RFC2440_CIPHER_AES_128</a></div><div class="ttdeci">#define RFC2440_CIPHER_AES_128</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00097">ecryptfs_kernel.h:97</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a15205f585ff88ccceaa7e24c3b496cd0"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a15205f585ff88ccceaa7e24c3b496cd0">RFC2440_CIPHER_AES_256</a></div><div class="ttdeci">#define RFC2440_CIPHER_AES_256</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00099">ecryptfs_kernel.h:99</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a82208e40f253521b728570377a2df859"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a82208e40f253521b728570377a2df859">RFC2440_CIPHER_TWOFISH</a></div><div class="ttdeci">#define RFC2440_CIPHER_TWOFISH</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00100">ecryptfs_kernel.h:100</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_ace74b19d0df31c4e067178a28f10d906"><div class="ttname"><a href="ecryptfs__kernel_8h.html#ace74b19d0df31c4e067178a28f10d906">RFC2440_CIPHER_CAST_6</a></div><div class="ttdeci">#define RFC2440_CIPHER_CAST_6</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00101">ecryptfs_kernel.h:101</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="crypto_8c_source.html#l01372">1372</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5319c22af6992f27d2bd1f7fb9aaa639"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structecryptfs__flag__map__elem.html">ecryptfs_flag_map_elem</a> ecryptfs_flag_map[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    {0x00000001, <a class="code" href="ecryptfs__kernel_8h.html#a6760f604dd9acf75a2c5d986f86b62d4">ECRYPTFS_ENABLE_HMAC</a>},</div>
<div class="line">    {0x00000002, <a class="code" href="ecryptfs__kernel_8h.html#a8beb950e35cab5bf60cb4a0a5693abc4">ECRYPTFS_ENCRYPTED</a>},</div>
<div class="line">    {0x00000004, <a class="code" href="ecryptfs__kernel_8h.html#a097504fe8e1e2af96cff430dccc70f25">ECRYPTFS_METADATA_IN_XATTR</a>},</div>
<div class="line">    {0x00000008, <a class="code" href="ecryptfs__kernel_8h.html#a89442acbb8deea4fbf29d77e97384143">ECRYPTFS_ENCRYPT_FILENAMES</a>}</div>
<div class="line">}</div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a097504fe8e1e2af96cff430dccc70f25"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a097504fe8e1e2af96cff430dccc70f25">ECRYPTFS_METADATA_IN_XATTR</a></div><div class="ttdeci">#define ECRYPTFS_METADATA_IN_XATTR</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00271">ecryptfs_kernel.h:271</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a8beb950e35cab5bf60cb4a0a5693abc4"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a8beb950e35cab5bf60cb4a0a5693abc4">ECRYPTFS_ENCRYPTED</a></div><div class="ttdeci">#define ECRYPTFS_ENCRYPTED</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00266">ecryptfs_kernel.h:266</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a6760f604dd9acf75a2c5d986f86b62d4"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a6760f604dd9acf75a2c5d986f86b62d4">ECRYPTFS_ENABLE_HMAC</a></div><div class="ttdeci">#define ECRYPTFS_ENABLE_HMAC</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00268">ecryptfs_kernel.h:268</a></div></div>
<div class="ttc" id="ecryptfs__kernel_8h_html_a89442acbb8deea4fbf29d77e97384143"><div class="ttname"><a href="ecryptfs__kernel_8h.html#a89442acbb8deea4fbf29d77e97384143">ECRYPTFS_ENCRYPT_FILENAMES</a></div><div class="ttdeci">#define ECRYPTFS_ENCRYPT_FILENAMES</div><div class="ttdef"><b>Definition:</b> <a href="ecryptfs__kernel_8h_source.html#l00274">ecryptfs_kernel.h:274</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="crypto_8c_source.html#l01292">1292</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4b9530ef94c35f4a3a133db1b7f89ba7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* ecryptfs_header_cache_1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01483">1483</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="af332c3f1c709eac519a4e0507188b93e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* ecryptfs_header_cache_2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l01484">1484</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6aa13d88e5e4790fd737d96db5a80b34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* ecryptfs_key_tfm_cache</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02027">2027</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6da5421d6633b1751d57eb37c78fa822"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char fake_iv[<a class="el" href="ecryptfs__kernel_8h.html#a916653fac2790272ac4c3fe28d111897">ECRYPTFS_MAX_IV_BYTES</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>eCryptfs: Linux filesystem encryption layer</p>
<p>Copyright (C) 1997-2004 Erez Zadok Copyright (C) 2001-2004 Stony Brook University Copyright (C) 2004-2007 International Business Machines Corp. Author(s): Michael A. Halcrow <a href="#" onclick="location.href='mai'+'lto:'+'mah'+'al'+'cro'+'@u'+'s.i'+'bm'+'.co'+'m'; return false;">mahal<span style="display: none;">.nosp@m.</span>cro@<span style="display: none;">.nosp@m.</span>us.ib<span style="display: none;">.nosp@m.</span>m.co<span style="display: none;">.nosp@m.</span>m</a> Michael C. Thompson <a href="#" onclick="location.href='mai'+'lto:'+'mct'+'ho'+'mps'+'@u'+'s.i'+'bm'+'.co'+'m'; return false;">mctho<span style="display: none;">.nosp@m.</span>mps@<span style="display: none;">.nosp@m.</span>us.ib<span style="display: none;">.nosp@m.</span>m.co<span style="display: none;">.nosp@m.</span>m</a></p>
<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</p>
<p>See the GPL-COPYING file in the top-level directory.</p>
<p>Copyright (c) 2010-2011 University of Utah and the Flux Group. All rights reserved. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00048">48</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a027b889665529024b5d98c658da25ed3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned char filename_rev_map[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </div>
<div class="line">    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </div>
<div class="line">    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </div>
<div class="line">    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </div>
<div class="line">    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </div>
<div class="line">    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, </div>
<div class="line">    0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, </div>
<div class="line">    0x0A, 0x0B, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </div>
<div class="line">    0x00, 0x0C, 0x0D, 0x0E, 0x0F, 0x10, 0x11, 0x12, </div>
<div class="line">    0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1A, </div>
<div class="line">    0x1B, 0x1C, 0x1D, 0x1E, 0x1F, 0x20, 0x21, 0x22, </div>
<div class="line">    0x23, 0x24, 0x25, 0x00, 0x00, 0x00, 0x00, 0x00, </div>
<div class="line">    0x00, 0x26, 0x27, 0x28, 0x29, 0x2A, 0x2B, 0x2C, </div>
<div class="line">    0x2D, 0x2E, 0x2F, 0x30, 0x31, 0x32, 0x33, 0x34, </div>
<div class="line">    0x35, 0x36, 0x37, 0x38, 0x39, 0x3A, 0x3B, 0x3C, </div>
<div class="line">    0x3D, 0x3E, 0x3F</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="crypto_8c_source.html#l02172">2172</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae1606c7dd8d7f89d2374af2373f03078"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlist__head.html">list_head</a> key_tfm_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02028">2028</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a102b127e075cb8e9aeb2886083755e55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct mutex key_tfm_list_mutex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l02029">2029</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a09d2f9ce53be8c025337c78c0301793f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char* portable_filename_chars</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<span class="stringliteral">&quot;-.0123456789ABCD&quot;</span></div>
<div class="line">                         <span class="stringliteral">&quot;EFGHIJKLMNOPQRST&quot;</span></div>
<div class="line">                         <span class="stringliteral">&quot;UVWXYZabcdefghij&quot;</span></div>
<div class="line">                         <span class="stringliteral">&quot;klmnopqrstuvwxyz&quot;</span>)</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="crypto_8c_source.html#l02165">2165</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e21752eb5e4b36c827bff61d317f78b6.html">services</a></li><li class="navelem"><a class="el" href="dir_c51145f6003b9bc92d3c8072bd9cc295.html">gaes</a></li><li class="navelem"><a class="el" href="dir_32c6c2c05be1954f867927059ab19ff9.html">ecryptfs</a></li><li class="navelem"><a class="el" href="crypto_8c.html">crypto.c</a></li>
    <li class="footer">Generated on Sun Dec 7 2014 14:58:23 for KGPU by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
